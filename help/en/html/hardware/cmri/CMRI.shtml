<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html lang="en">
<head>
 <title>JMRI Hardware Support - Chubb C/MRI</title>
    <meta name="Author" content="Bob Jacobsen, Egbert Broerse">
    <meta name="keywords" content="Bruce Chubb C/MRI Computer interface java model railroad JMRI install windows">

<!-- Style -->
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<link rel="stylesheet" type="text/css" href="/css/default.css" media="screen">
<link rel="stylesheet" type="text/css" href="/css/print.css" media="print">
<link rel="icon" href="/images/jmri.ico" type="image/png">
<link rel="home" title="Home" href="/">
<!-- /Style -->
</head>

<body>
<!--#include virtual="/Header" -->

  <div class="nomenu" id="mBody">
    <div id="mainContent">

<h1>Hardware Support: Chubb C/MRI</h1>

<a name="contents"></a>
<p>The documentation below discusses how JMRI may be used with C/MRI, and 
how to get started with connecting a C/MRI system to JMRI. It assumes a basic
knowledge of JMRI (as documented on this JMRI web site), and some familiarity
with C/MRI. It is highly recommended that C/MRI users have access to Bruce
Chubb's <b>C/MRI User Manual, Version 3.0</b>, because it contains 
detailed hardware documentation not available elsewhere. Since you don't 
need to program your computer if you're using JMRI with your C/MRI system, 
you can skip over computer programming details when consulting the C/MRI
User Manual. The documentation below is divided into sections; for 
easy access click an item in this list:
<ul><!-- TOC -->
<li><a href="#hardware">Hardware</a></li>
<li><a href="#limitations">Limitations</a></li>
<li><a href="#intro">Introduction to C/MRI on JMRI</a>
	<ul><li><a href="#iobits">C/MRI Input and Output Bits</a></ul></li>
<li><a href="#connecting">Connecting</a>
<ul>
	<li><a href="#smini">Getting Started with an SMINI node</a>
	<li><a href="#susic">Getting Started with a USIC or SUSIC</a>
	<li><a href="#nodes">Managing Nodes</a>
	<li><a href="#numbers">Numbering used in C/MRI System Names</a>
	<li><a href="#alternate">Alternate Numbering for System Names</a>
	<li><a href="#options">C/MRI Turnout Control Options</a>
	<li><a href="#signals">Wiring Signals</a>
	<li><a href="#usb">Using USB-Serial Adapters</a>
	<li><a href="#net">Using A Network Connection</a>
	<li><a href="#sim">Running JMRI when disconnected from your C/MRI system</a>
</ul></li>
<li><a href="#tools">JMRI C/MRI Tools</a></li>
<ul>
	<li><a href="#diagnostics">C/MRI Diagnostics</a>
	<li><a href="#confignodes">Configure Nodes Tool</a>
</ul>
<li><a href="#documentation">Documentation</a></li>
</ul>

<a name="hardware"></a><h2>Supported Hardware</h2>
<ul>
<li>Chubb C/MRI USIC
<li>Chubb C/MRI SMINI
<li>Chubb C/MRI SUSIC
</ul>

<a name="limitations"></a><h2>Limitations</h2>
<p>At this time, the directly connected IBEC and UBEC interfaces are not supported.

<a name=intro></a><h2>Introduction to C/MRI on JMRI</h2>

<p>C/MRI is a system of digital input and digital output lines that can be
used to connect a computer to a model railroad layout, allowing computer 
monitoring and control of various things of the layout. The SUSIC (Super 
Universal Serial Interface Card) is the controller board for a large digital 
I/O system supporting, via a motherboard, up to 64 digital input and digital 
output cards, with either 24 or 32 input or output lines per card. The USIC 
is an older version of the SUSIC. The SMINI (Super Mini-node) card is a stand- 
alone serial node providing a fixed 24 input lines and 48 output lines. A 
number of other interface boards are available as part of C/MRI, but they 
all connect to your computer via an SMINI, a SUSIC, or a USIC. For example,
C/MRI's DCCOD occupancy detector board connects to an SMINI (or SUSIC or 
USIC) input line. Layouts that use C/MRI will commonly have several SMINI's 
located at different places on the layout, and perhaps one or two SUSIC's 
located at CTC panels.</p> 	

<p>C/MRI is not a train control system. You may run C/MRI with a DCC train 
control system (such as, Digitrax, Lenz, or NCE) or with a DC train control 
system. And you can use JMRI with your C/MRI system whether you are using 
DCC or DC to control your trains. If you are controlling your trains with a 
system that JMRI supports, you can connect your C/MRI system and your train 
control system to JMRI simultaneously, each with its own serial input line 
into your computer. Most C/MRI users who use JMRI run with connections to 
both their C/MRI and their train control system. There are many advantages 
to doing so. JMRI allows you to "mix and match" how you control and monitor 
things on your layout.  For example, you can switch your Turnouts (track 
switches) using static decoders on your train control system, 
and simultaneously use C/MRI inputs to provide Turnout Feedback to JMRI. 
JMRI is designed to make both connected systems work smoothly together. 

<p>JMRI software consists of a large library, divided into 1) a system 
specific part, with many subparts, each of which communicates with one 
supported hardware system, like C/MRI, in a system specific way, and 2) a 
system-independent part where most of the features of JMRI are 
implemented. So, for example, if the user does something (perhaps setting a
route) to cause JMRI to throw a Turnout (track switch), that user action 
will occur in the system-independent part of the software, and then JMRI will 
send out the actual command via the system-dependent part appropriate to the
hardware system controlling the particular Turnout thrown. JMRI is designed 
so that features are implemented in the system-independent part as much as
possible, with JMRI using system-dependent subparts only when really necessary. 
Access to system-independent features is via the main JMRI menus, such as 
the Tools menu.  Access to system-dependent features is via a menu titled 
for the hardware system supported; C/MRI specific features are accessed via 
the CMRI menu.</p>

<p>JMRI presents itself to users via several application front ends, each 
focusing on a type of use, but all based on the same underlying software 
library. The popular DecoderPro application focuses on programming DCC 
decoders, and is not of much interest to C/MRI. On the other hand, PanelPro 
is the JMRI application that focuses on layout automation, signaling, and CTC 
panels. PanelPro is the application most often used with C/MRI, and is
the one used in the examples <a href="#smini">below</a>. Since all JMRI
applications use the same library, it is possible to run a panel from 
DecoderPro, or even program a DCC decoder from PanelPro. 
It's just not quite as
easy as using the focused application.</p> 

<p>JMRI libraries have built-in support for C/MRI serial hardware using the 
USIC, SUSIC and SMINI. Each SMINI, USIC or SUSIC is a serial node capable of 
communicating independently with a computer via serial I/O. Several C/MRI 
nodes may be connected together using the RS485 communication protocol in a 
daisy chain configuration, so that only one serial line into your computer is 
required. For this to work, each node must have a different unique address 
set into the address switches on its board. Each node (USIC, SUSIC, or 
SMINI) needs to receive an initialization string before it can communicate 
with a computer. JMRI will automatically create and transmit the required 
initialization string when it starts up, but to make this possible, you 
need to tell JMRI the details of how your C/MRI hardware is set up. The 
process of doing so is called "configuring" your C/MRI node 
(<a href="#nodes">see below</a>). If you daisy chain several C/MRI nodes, you
probably will need a C/MRI RS232 to RS485 conversion card between the RS485
bus connecting the cards and the RS232 serial line to connect to your 
computer. If your computer doesn't have an RS232 serial port (most newer 
computers don't), you can connect to a USB computer port with a USB-to-serial 
adapter (<a href="../USBtoSerial.shtml">click here for help</a>).</p>	

<p>C/MRI inputs can be used as JMRI 'Sensors', and C/MRI outputs can be driven 
as JMRI 'Turnouts' or JMRI 'Lights' (<a href="#iobits">see below</a>). Note 
that C/MRI inputs and outputs are sometimes called 'pins', sometimes called 
'bits', and sometimes called 'lines'; all are equivalent ways to refer to 
same things. C/MRI is a polling system, which means that communicating with 
C/MRI nodes requires that the computer periodically send a message to each
node asking it to transmit the status of its input bits. JMRI begins to 
poll a node when at least one Sensor has been set up to refer to an input 
bit on that node. It is this polling action that keeps the LED's on your
SMINI flashing at a high rate.</p>

<a name=iobits></a><h3>C/MRI Input and Output Bits</h3>

<p>JMRI refers to C/MRI input bits as Sensors. Sensors provide input to JMRI 
about conditions on the layout--a button is pushed, a block is occupied, 
etc. Within JMRI, you refer to a C/MRI input bit (Sensor) by its "system 
name", CSnxxx, where nxxx is the address of the bit 
(<a href="#numbers">see below</a>). Before you can refer to a Sensor in JMRI, 
it must be "created". A Sensor may be created in a number of ways, including 
automatically.  All JMRI Sensors that have been created may be viewed in the
JMRI Sensor Table, accessed by selecting <b>Sensor Table</b> in the Tools 
menu. A new Sensor may be created via the Sensor Table as illustrated 
<a href="#smini">below</a>. Creating a Sensor to refer to a specific C/MRI 
input bit, is called "assigning" that input bit. Each input bit may be 
assigned only once, i.e., two different Sensors may not refer to the same
C/MRI input bit. A Sensor is "active" when its assigned input bit is on 
(grounded) and "inactive" when its input bit is off. <b>So when you see 
"Sensor", think "input bit" or "input line".</b></p>

<p>JMRI refers to C/MRI output bits as Turnouts or Lights. Turnouts and 
Lights are on/off switches that JMRI can change to control things on 
your layout. To refer to a C/MRI output bit as a Turnout, use the System Name 
CTnxxx, where nxxx is the address of the output bit 
(<a href="#numbers">see below</a>). To refer to a C/MRI output bit as a 
Light, use CLnxxx, where nxxx is the address of the output bit 
(<a href="#numbers">see below</a>). Turnouts and Lights are different methods 
of referring to C/MRI outputs from within JMRI.  Each method has 
different control options. Always use 'Turnouts' for C/MRI outputs used to 
control Turnouts (track switches) and for C/MRI outputs used to operate 
signals.  For historical reasons, C/MRI output bits used to control signal 
aspects are referred to as 'Turnouts', even if the output bits are used to 
control Lighted signals.  Use 'Lights' to refer to C/MRI output bits used 
for fascia panel Lights, for Lights in scenery (structure Lighting, street 
Lights, etc.), and for special purposes where the control options for Lights 
suit your needs. <b>So when you see "Turnout" or "Light" in connection with 
C/MRI, think "output bit" or "output line".</b></p>

<p>Before you can refer to a Turnout or a Light within JMRI, the Turnout or
Light must be "created". A Turnout may be created in a number of ways, 
including automatically. All JMRI Turnouts that have been created may be 
viewed in the JMRI Turnout table, accessed by selecting <b>Turnout Table</b> 
in the Tools menu. A new Turnout may be created via the Turnout table by 
clicking "Add" at the bottom of the table. Similarly, a new Light may be 
created via the JMRI Light Table by clicking "Add" at the bottom of that 
table.  The JMRI Light Table is accessed by selecting <b>Lights</b> in 
the Tools &gt; Tables menu. All JMRI Lights that have been created are listed in the 
JMRI Light Table. Creating a Turnout or a Light to refer to a specific C/MRI 
output bit, is called "assigning" that output bit. Each Light or Turnout is 
linked to a specific output line via the address part of the System Name. 
</p>

<p>A specific output bit may be referred to as a Turnout or a Light, but not 
both. Each output bit may be assigned only once. When a new C/MRI Turnout or 
a new C/MRI Light is created, JMRI checks 
that the specified output bit is available for assignment. If the requested 
C/MRI output bit is in use by a Turnout or a Light, JMRI will refuse to 
create the new Turnout or new Light.  Note that some C/MRI Turnout control 
options use two output bits, the addressed one and the next one 
(<a href="#options">see below</a>), and that both output bits must be 
unassigned for successful creation of a new Turnout controlled by two output 
bits. Lists of current C/MRI bit assignments can be obtained by selecting 
<b>List Assignments</b> in the CMRI menu.</p>

<a name="connecting"></a><h2>Connecting</h2>
<a name=smini></a><h3>Getting Started with an SMINI node</h3>

<p>It's easiest to try JMRI with a SMINI board, as there are few
options to be configured for the C/MRI hardware. After you have 
physically connected your SMINI to your computer, follow the procedure 
below to configure your SMINI as a C/MRI node, and test an input and
an output bit. (The procedure assumes nothing is connected to the 
input and output pins of your SMINI, and that you haven't made any
assignments for its bits.)
<ol>
<li>Start the PanelPro program.
<li>From the Edit menu, select <b>Preferences...</b> and configure:
    <ul>
    <li>For layout connection select "C/MRI".
    <li>For serial port, select the port your C/MRI hardware is attached
        to.
    <li>Select the baud rate your C/MRI system uses.
    <li>Click the "Configure C/MRI nodes" button. On the
            new panel that opens:
        <ul>
        <li>Enter your SMINI's node address. (0 is typically used for 
            the first SMINI card, but enter whatever number is in the 
            address switches on your SMINI board.)
        <li>Select "SMINI" for node type.
        <li>Leave DL at zero.
        <li>Click "Add Node".
        <li>Click "Done".
        </ul>
    <li>Back on the "Preferences" panel, click "Save", and say yes 
        when it asks if you want to quit.
    </ul>
<li>Restart the program. You need to assign an input bit to start 
    polling. Select <b>Sensor Table</b> from the Tools menu, and proceed:
    <ul>
    <li>Click "Add..." at the bottom of the table.
    <li>In the Add New Sensor dialog:
        <ul>
        <li>For System Name, enter CS1 if your SMINI's node address was
            0, or else enter CSn001, where n is your SMINI's node address.
        <li>For User Name enter "Test".
        <li>Click "OK".
        </ul>
    <li>The System Name and User Name will appear in the Sensor Table. 
        The state of your Sensor in the Sensor Table will initially be 
        "Unknown", but will quickly switch to "Inactive" when polling 
        begins (assuming nothing is connected to input pin 1).
    </ul>
    The transmit and receive LED's on your SMINI board should now be 
    flashing, indicating that the computer and the SMINI are talking.
<li>To check that the input bit (Sensor) you assigned is working, 
    connect a jumper wire from input pin 1 to the ground terminal on your 
    SMINI board.  The Sensor should switch to "Active". The Sensor state 
    will alternate between "Active" and "Inactive", according to whether
    pin 1 is grounded or not.
<li>To check that everything is working on the output side, select 
    <b>Turnout Control</b> from the Tools menu.  When the small Turnout 
    Control window opens, proceed:
    <ul> 
    <li>For Turnout, enter CT1 if your node address was 0, or else 
        enter CTn001, where n is your node address. (This assigns output
        bit 1 of your SMINI as a Turnout.)
    <li>Click "Closed" or "Thrown" to turn output line 1 on and off.
    </ul>
    If you connect an LED in series with a resistor (ohm size depends 
    upon the direct current voltage applied) to output bit 1, you will 
    be able to turn the LED on and off by simply clicking "Closed" or 
    "Thrown" in the Turnout control window.  Note that SMINI output bits 
    can be set up to be either "current sinking" or "current sourcing". 
    (Which you have depends on how your SMINI is constructed.) JMRI 
    works the same, independent of the type of output bit, but the type 
    of output bit determines how you hook up your LED. If your output
    bits are current sinking (the most common type), connect the 
    negative lead of your LED to output pin 1, and connect the resistor 
    between the positive LED lead and a source of direct current (usually 
    3 to 12 volts). If your output bits are current sourcing, connect
    the positive lead of your LED to output pin 1, and connect the 
    resistor between the negative lead and direct current ground.  				
</ol>
<p>You now have one C/MRI node configured and working. You may add
    more nodes, by returning to the Configure C/MRI Nodes dialog 
    (<a href="#nodes">see below</a>).

<a name="susic"></a><h3>Getting Started with a USIC or SUSIC</h3>

After you have physically connected your SUSIC (or USIC) to your computer, 
follow the procedure below to configure your SUSIC (or USIC) as a C/MRI 
node, and test an input bit and an output bit. The procedure assumes 
that 1) this SUSIC is the first C/MRI node being connected to your 
computer, 2) that nothing is connected to the input pins of your SUSIC's 
first digital input card, or the output pins of your SUSIC's first 
digital output card, and 3)	that you haven't made any assignments for 
your SUSIC's bits.</p>
<ol>
<li>Start the PanelPro program.
<li>From the Edit menu, select <b>Preferences...</b> and configure:
    <ul>
    <li>For layout connection select "C/MRI".
    <li>For serial port, select the port your C/MRI  hardware is attached to.
    <li>Select the baud rate your C/MRI system uses
    <li>Click the "Configure C/MRI nodes" button. On the
        new panel that opens:
        <ul>
        <li>Enter your SUSIC's node address. (0 is typically used for 
            the first SUSIC module, but enter whatever number is in the 
            address switches on your SUSIC controller board.)
        <li>Select "USIC_SUSIC" for node type. 
        <li>Leave DL at zero.
        <li>Select "24-bit" or "32-bit" for card size, depending
            on whether you have the original 24-bit or newer 32-bit 
            DIN and DOUT cards.
        <li>Use the table below to configure your cards and tell JMRI
            which card addresses have input cards and which have output
            cards. For each card you've installed, click where it 
            says "No Card" and select "Input Card" or "Output Card". 
            Note that the input and output cards may be in any order, 
            but there must be no empty slots before the one following 
            the last installed card. (This is a C/MRI hardware 
            requirement.)
        <li>Click "Add Node"
        <li>Click "Done"
        </ul>
    <li>Back on the "Preferences" panel, click "Save", and say yes when 
    it asks if you want to quit.
    </ul>
<li>Restart the program. You need to assign an input bit to start 
    polling. Select <b>Sensors</b> from the Tools &gt; Tables menu, and proceed:
    <ul>
    <li>Click "Add..." at the bottom of the Sensor Table pane.
    <li>In the Add New Sensor dialog:
        <ul>
        <li> For System Name, enter CS1 if your SUSIC's node address was
            0, or else enter CSn001, where n is your SUSIC's node address.
        <li> For User Name enter "Test".
        <li> Click "OK".
        </ul>
    <li>The System Name and User Name will appear in the Sensor Table. 
        The state of your Sensor in the Sensor Table will initially be 
        "Unknown", but will quickly switch to "Inactive" when polling 
        begins (assuming nothing is connected to input pin 1).
    </ul>
    The transmit and receive LED's on your SUSIC controller board should 
    now be flashing, indicating that the computer and the SUSIC are 
    talking.
<li>To check that the input bit (Sensor) you assigned is working, 
    connect a jumper wire from input pin 1 (the first input pin on the
    first input card of your SUSIC) to direct current ground.  
    The Sensor should switch to "Active". The Sensor state 
    will alternate between "Active" and "Inactive", according to whether
    pin 1 is grounded or not.
<li>To check that everything is working on the output side, select 
    <b>Turnout Control</b> from the Tools menu. When the small Turnout 
    Control window opens, proceed:
    <ul> 
    <li>For Turnout, enter CT1 if your SUSIC's node address was 0, or 
    else enter CTn001, where n is your SUSIC's node address. This 
    assigns output bit 1 (the first output line on the first output card 
    of your SUSIC) as a Turnout.
    <li>Click "Closed" or "Thrown" to turn output line 1 on and off.
    </ul>
    If you connect an LED in series with a resistor (ohm size depends 
    upon the direct current voltage applied) to output bit 1, you will 
    be able to turn the LED on and off by simply clicking "Closed" or 
    "Thrown" in the Turnout control window. Alternatively you can use
    a meter set to measure direct current to detect a change in output
    bit 1 as it is switched on and off.
</ol>
<p>You now have one C/MRI node configured and working. You may add
    more nodes, or edit the DIN/DOUT card configuration of this SUSIC node, 
    by returning to the Configure C/MRI Nodes dialog 
    (<a href="#nodes">see below</a>).  

<a name="nodes"></a><h3>Managing Nodes</h3>

Each SMINI, USIC or SUSIC is called a "node".  Before using C/MRI with 
JMRI, you must tell JMRI what nodes you have on your system and the 
configuration of each node.  When you select C/MRI in the Preferences 
dialog, a "Configure C/MRI nodes" button is displayed.  Click this button 
to bring up a dialog for entering node configuration information. You can 
add new nodes or update an existing node's configuration by returning to the 
Preference dialog (<b>Edit &gt; >Preferences...</b>) or by selecting <b>Configure 
C/MRI Nodes</b> in the CMRI menu.  Make sure to save your 
Preferences after making changes to your node configuration. Use the "Save" 
button in the Preferences window.</p>
<p>A node's address is set using the address switches on your C/MRI board. 
(Node addresses are called UA in C/MRI manuals.) Node addresses must be 
unique for each board, but need not be sequential. The node address is used 
in the JMRI System Name to reference input and output bits belonging to that 
node (<a href="#numbers">see below</a>).</p>
<p>Configuring C/MRI nodes using the configuration dialog is simple. For an 
SMINI, simply enter the Node Address as set in the address switches on the 
SMINI board, select SMINI for the Node Type, and click the "Add Node" 
button.  For a USIC or SUSIC, enter the node address, select USIC_SUSIC, 
select 24-bit or 32-bit cards, then tell JMRI what type cards are in 
occupied slots.</p>
<p>For each node, you can view a summary list of C/MRI bits that are in 
use and those that are available.  Select <b>List Assignments</b> in the 
CMRI menu to bring up the List C/MRI Assignments dialog.  Then select the 
node of interest from the list of configured nodes, and whether you want to 
view input bit assignments or output bit assignments.  The assignments being 
viewed may be printed by clicking the Print button at the bottom of the 
dialog.</p>
<p><b>List Assignments</b> is useful for checking that you have
configured the correct numbers of input and output bits and the correct node 
address for each node.  The List Assignments software works from the current 
C/MRI configuration, so if a node has been configured, it will be selectable 
in the List C/MRI Assignments dialog. The Assignment Table contains a line 
for each configured input or output bit. Each line also contains an address 
column showing what address to use for that bit in JMRI's C/MRI system 
names.  Printing blank assignment lists for each node provides a convenient 
paper form for use in setting up your input/output bit assignments.</p>

<a name="numbers"></a><h3>Numbering used in C/MRI System Names</h3>

<p>C/MRI System Names start with "C". For example, "CS24" is a C/MRI 
"S"ensor, the 24th input line, "CL35" refers to the 35th output line as 
a "L"ight, and "CT38" refers to the 38th output line as a "T"urnout (all
for a node with address of 0).</p>

<p>For each node, inputs and outputs are numbered sequentially from 1, without
worrying about the types of cards, or what type card is in what card slot. 
For example, if you have two 24-bit input cards, CS25 refers to the 1st input 
line on the second input card.  If you have two 32-bit input cards, CS25 
refers to the 25th input line on the first input card.</p>

<p>Each SMINI, USIC or SUSIC (node) has a unique address set into its 
hardware address switches and entered when you configured each C/MRI node 
(<a href="#nodes">see above</a>). 
Sensors and Turnouts on the first node (address 0) are numbered from 1 to 
999; Sensors and Turnouts on the second node (address 1) are numbered 1001 
to 1999; etc. Note that node addresses may be sequential, but are not 
required to be so.</p>

<p>For example:
<ul>
<li>Say you have a SMINI with it's address switches set to "2". All of the
inputs and outputs on that node will be numbered starting with 2001.  
    <ul>
    <li>CT2001 is the first output pin
    <li>CT2048 is the last output pin
    <li>CS2001 is the first input pin
    <li>CS2024 is the last input pin.
    </ul>
<li>If you have a USIC with it's address switches set to "1", it will
have all it's inputs and outputs numbered starting with 1001.  If it has
three 24-bit input cards, and two 24-bit output cards, their addresses will be:
    <ul>
    <li>CT1001 is the first pin on the 1st output card
    <li>CT1024 is the last pin on the 1st output card
    <li>CT1025 is the first pin on the 2nd output card
    <li>CT1048 is the last pin on the 2nd output card
    <li>CS1001 is the first pin on the 1st input card
    <li>CS1024 is the last pin on the 1st input card
    <li>CS1025 is the first pin on the 2nd input card
    <li>CS1049 is the first pin on the 3rd input card
    <li>CS1072 is the last pin on the 3rd input card
    </ul>
Note that it doesn't matter what order the cards are installed. That's
configured when you put together the hardware. JMRI is told what type
card is installed in what USIC slot when you define the node in the 
C/MRI configuration dialog (<a href="#nodes">see above</a>). 
<li>Is you have a SUSIC with it's address switches set to "4", the inputs
and outputs will be numbered starting with 4001.  If it has two 32-bit input
and two 32-bit output
cards, their addresses will be:
    <ul>
    <li>CT4001 is the first pin on the 1st output card
    <li>CT4032 is the last pin on the 1st output card
    <li>CT4033 is the first pin on the 2nd output card
    <li>CT4064 is the last pin on the 2nd output card
    <li>CS4001 is the first pin on the 1st input card
    <li>CS4032 is the last pin on the 1st input card
    <li>CS4033 is the first pin on the 2nd input card
    <li>CS4064 is the last pin on the 2nd input card
    </ul>
</ul>

<p>When entering Hardware information into the Add Sensor window you can 
Enter in the Node Id, followed by the Sensor Id, separated by a ":".  
This method can also be used for the alternative/extended addressing.<br>
So for a Sensor on Node 2, pin 3 you would enter the following into the hardware
address field : <b>2:3</b></p>

<p>To summarize, input and output pins are labeled sequentially
within each C/MRI node.  To complete the bit address, add 1000 times the
node address to the pin number. Node addresses can go as high as the C/MRI 
hardware allows.</p>
<p>For an easy guide to input and output pins addresses, select <b>List 
Assignments</b> in the CMRI menu to access tables listing assigned and 
available inputs and outputs for each node. Each table has a line for each 
pin including an address column showing what address to use for that pin in 
System Names.</p>   	

<a name="alternate"></a><h3>Alternate Numbering for System Names</h3>

<p>An alternate scheme for numbering in C/MRI System Names was developed 
to give user access to the full number of lines allowed by C/MRI hardware design.
The main numbering system (<a href="#numbers">documented above</a>) allows 
access to 999 input and output lines on each node. The C/MRI hardware design, 
however, supports many more bits for USIC and SUSIC nodes. Most JMRI users 
will never need this alternate scheme, and should use the main numbering scheme.
<p>
The alternate numbering scheme is similar to the main numbering scheme,
except the node address and bit number are separated by a "B",
and both node address and bit number can range to any value supported by C/MRI.
For example, CS1B13 refers to input line 13 of a node with address 1, and is 
equivalent to CS1013 in the main numbering scheme. Also CT2B1109 refers to 
output line 1109 of a node with address 2, and there is no equivalent in the 
main numbering scheme. Users may use either numbering scheme interchangeably 
for line numbers up to 999, but must use the alternate numbering scheme for 
line numbers greater than 999. For ease in communicating with other users, 
using the main numbering scheme is recommended unless bits greater than 999
need to be addressed.

<a name="options"></a><h3>C/MRI Turnout Control Options</h3>

<p>Turnouts (switches) may be controlled using one or two output bits.  
When a Turnout is created using the Add option in the Turnout Table, 
the user is asked whether the Turnout is to be controlled using one 
or two output bits.  
<p>
If one-output-bit control is selected, the user must select either 'steady state'
or 'pulsed' control. If 'steady state' is selected, then that output bit is set 
"Off" for CLOSED ('normal' in C/MRI manuals) or "On" for THROWN ('reverse' in 
C/MRI manuals). When setting the output bit, JMRI compares the requested state 
to the state indicated by the current value of the output bit. If these states 
are different, then the output bit is set as indicated above. If these states 
are the same, that state is compared to the state indicated by Turnout Feedback. 
If the states are the same, no action is taken since the Turnout is already in 
the requested state. If the states are different, the Turnout was probably 
changed by some means separate from JMRI. To ensure the Turnout is actually 
set to the requested state, the output bit is first changed to match the state 
indicated by the Turnout Feedback, then one second later it is changed again to 
match the requested state. This guarantees a change of state for those Turnout 
control devices that require a change in state to actually move the Turnout.
<p>
If one-output-bit with pulsed control is selected, the output bit is "Off" when 
nothing is happening. When CLOSED or THROWN is requested, this request is 
compared to the known state of the Turnout (which follows Turnout Feedback). 
If the known state indicates the Turnout is already in the requested state, 
nothing is done. If the known state is different from the requested state, then 
the bit is 'pulsed'.  A 'pulse' consists of the bit being turned "On" for one 
second, then returned to the "Off" position. 
<p>
If two-output-bit control is selected, the bit referenced in the Turnout system 
name (see above) and the next bit in sequence are used to control the Turnout. 
For example, if CT33 has two-output-bit control, the 33rd and 34th bits are 
used to control the Turnout. If two-output-bit control is selected, the user 
must select either 'steady state' or 'pulsed' control.  Steady state control 
should be selected for stall motor Turnouts, such as a Tortoise, if it is being 
controlled according to the recommendation in Chubb's C/MRI User's Manual, 
Version 3.0, page 3-12. With steady state control, for CLOSED, the first bit is 
set "Off" and the second bit is set "On"; for THROWN, the bits states are 
reversed, i.e., the first bit is set "On" and the second bit is set "Off". 
<p>
If two-output-bit control with pulse control is requested, both bits are "Off" 
when nothing is happening. When CLOSED or THROWN is requested, this request is 
compared to the known state of the Turnout (which follows Turnout Feedback). If 
the known state indicates the Turnout is already in the requested state, 
nothing is done. If the known state is different from the requested state, then 
the first bit is pulsed if CLOSED is requested, or the second bit is pulsed if 
THROWN is requested.  In either case, a 'pulse' consists of the bit being 
turned "On" for one second, then returned to the "Off" position.
<p><I>Note that to have two-output-bit control,
a Turnout must be created using the "Add" button in the Turnout Table.</I>
<p>
Finally, the "inverted" option can be selected.  This controls
how the C/MRI hardware implements the "On" and "Off" used in the 
description above.  Normally (invert option not selected),
"On" refers to a "1" to the hardware; with standard C/MRI hardware,
this pulls the output pin down and allows it to sink current.  "Off"
the corresponds to a "0" to the hardware, turning the output pin off, 
and causing it to stop sinking current.
<p>
When "invert" is selected, "On" results in a "0" sent to the hardware, and
"Off" results in a "1" being sent.  This causes the hardware to act with
the opposite polarity.
</dd>

<h3>Wiring</h3>
<a name="usb"></a><h4>Using USB-serial adapters</h4>

<p>Most C/MRI systems use RS485 electrical signals to communicate between
the nodes and the computer.  There are several ways to generate them:
<ol>
<li>If your computer has a built-in serial port (RS232 connection), you can use 
an RS232-to-RS485 convertor.  There's one you can build as 
part of the C/MRI system, or you can buy a commercial one.
<li>If your computer has a USB port, you can buy a commercial
USB-toRS485 adapter and use that.
<li>If your computer has a USB port and you have a RS232-to-RS485
convertor, you can install a USB-to-RS232 adapter (sometimes called
a "USB-to-serial converter"), then connect the RS232 output of that to the
RS232 input of the RS232-to-RS485 convertor.  
Note that if you're using the Chubb RS232-to-RS485 converter, some 
USB-to-RS232 adapters will require that you connect certain 
RS232 control leads that are not handled by the Chubb convertor:
    <ul>
    <li>DSR - DTR (pins 4 &amp; 6 on the DB9 connector)
    <li>RTS - CTS (pins 7 &amp; 8 on the DB9 connector)
    </ul>
</ol>
<p>
In all cases, the communications line will end up appearing
as a serial port on your computer. In Windows, this is a COM port,
in other computers it's a named serial device. You'll have to select
the proper one when configuring JMRI.

<a name="net"></a><h4>Using A Network Connection</h4>

<p>JMRI allows you to connect to C/MRI nodes through a 
network connection.  JMRI communicates via the
TCP/IP protocol
across a network to a network-to-serial adapter, 
which converts the network connection to a serial 
stream that then goes through a RS485 convertor to the C/MRI node(s).
<p>
The network-to-serial adapter is sometimes called
a "<a href="../TerminalServer.shtml">terminal server</a>". It's also sometimes called
a "Lantronix box" after an early manufacturer of these, though
they're now available from multiple sources. The adapter
has to be configured with the correct serial parameters for
your C/MRI system, including the proper baud rate and 8-data-bits, no parity.
You will probably need a RS232-to-RS485 adapter on the output of the
network adapter.
<p>
Some hobbyists have also built C/MRI nodes that 
have native Ethernet connections. JMRI communicates
with them via a direct TCP/IP connection using the C/MRI protocol,
but in this case there's no need for a RS485 convertor.
<p>
To configure JMRI to use a network connection, go to the Preferences
screen, Connections tab. After selecting C/MRI for the System Manufacturer,
select "Network Interface" for the System Connection.  Then enter the IP address 
(or node name, if it has one) of your network-to-serial adapter in the
IP Address / Host Name field.  If it uses a non-standard port number,
check the Additional Configuration Settings box and enter the port number.
Click Save and restart the program.  

<a name="signals"></a><h4>Wiring Signals</h4>
<p>
JMRI can work with all the popular ways of wiring 
signals to C/MRI hardware (and there are a lot of them!)
For information on how to configure your signals to the
program, please see the 
<a href="Signals.shtml">C/MRI signals</a> page.  

<a name="sim"></a><h3>Running JMRI when disconnected from your C/MRI system</h3>

<p>JMRI continually polls the C/MRI hardware for status changes.
If one or more C/MRI nodes are not responding, eventually their inputs (Sensors)
are set to the UNKNOWN state to indicate that JMRI has lost contact with 
those devices on the layout.
<p>
Although this is the right thing to do when you're really connected to the
hardware and trying to operate the layout, it can get in the way if you're 
running JMRI without your layout connection.  
You might want to do this, for example, to work on your panels while 
away from the layout, or while the layout needs to be powered off for some reason.
<p>
To accommodate using JMRI without an active layout connection, 
in the JMRI 2.3.2 release a "C/MRI Simulator" connection was made available
in the Preferences.
<p>
<i>Please note that this is only meant for users who already have a working
C/MRI connection already configured. Please do not try to 
use the C/MRI simulator before configuring a valid connection to C/MRI hardware, 
as it will not work.</i>
<p>
Once you have your C/MRI connection configured, when your hardware is
not available you can just go to the JMRI Preferences, select "C/MRI Simulator", 
save Preferences, quit and restart. Don't change any other settings!
<p>
When the C/MRI hardware is again available, go the JMRI Preferences, 
select "C/MRI Serial", save Preferences, quit and restart.

<a name="tools"></a><h2>JMRI C/MRI Tools</h2>
<img src="images/CMRImenu416.png" alt="Config Pane" align="right" height="162" width="213"></a>
<p>The CMRI menu contains 5 tools:

<a name="monitor"></a><h3>CMRI Monitor</h3>
<p>Lists all Serial Commands seen on the connection.

<a name="sendcommand"></a><h3>Send Command</h3>
<a href="images/CMRIMonitor.png">
<img src="images/CMRIMonitor.png" alt="Monitor Pane" height="112" width="350"></a>&nbsp;
<a href="images/CMRISendSerialCommand.png">
<img src="images/CMRISendSerialCommand.png" alt="Monitor Pane" height="73" width="123"></a>

<a href="images/CMRIDiagnostic.png">
<img src="images/CMRIDiagnostic.png" alt="Diagnostic Pane" height="164" width="235" align="right"></a>
<a name="diagnostics"></a><h3>Run Diagnostic</h3>
<p>
JMRI supports the two automated diagnostic procedures mentioned in 
Chapter 6 of Bruce Chubb's <b>C/MRI User's Manual, Version 3.0</b>. Diagnostics
are useful for checking the functioning of your C/MRI hardware. These automated 
procedures are controlled via a dialog available by selecting 
<b><a href="../../../package/jmri/jmrix/cmri/serial/diagnostic/DiagnosticFrame.shtml">Run Diagnostic</a></b>
in the CMRI menu.<br>
The <strong>Wraparound Test</strong> requires a special 
wraparound test cable, and the <strong>Output Test</strong> requires a special output test card.  
Both devices are described in the above reference. Any other connections to input
or output bits on the card(s) being tested should be unplugged when these tests 
are run. The diagnostics are easy to use.  Simply follow the instructions presented 
in the Run C/MRI Diagnostic dialog.  Any errors found are reported in the status 
box of the dialog.</p>

<a href="images/CMRIConfigNodesSMINI.png">
<img src="images/CMRIConfigNodesSMINI.png" alt="Config Pane" align="right" height="202" width="218"></a> 
<a href="images/CMRIConfigNodesUSIC.png">
<img src="images/CMRIConfigNodesUSIC.png" alt="Config Pane" align="right" height="202" width="218"></a>
<a name="confignodes"></a><h3><a href="../../../package/jmri/jmrix/cmri/serial/nodeconfig/NodeConfigFrame.shtml">Configure C/MRI Nodes</a></h3>
<p>Select "Configure C/MRI Nodes" from the <strong>CMRI</strong> menu, and from to top right hand dropdown list choose either an SMINI or USIC Node Type to configure. Next enter a Node Number in the left hand field and click on one of the little 
check-boxes to configure a specific output.<br>
Click "Edit Node" to update, then close the pane.

<a name="monitor"></a><h3>List Assignments</h3>
<a href="images/CMRIList.png">
<img src="images/CMRIList.png" alt="List Pane" height="140" width="212"></a>

<a name="documentation"></a><h2>Documentation</h2>
<h3>JMRI Help</h3>
<ul>
<li><a href="Signals.shtml">C/MRI signals</a></li>
</ul>

<h3>Third Party info</h3>
<p>For more information on C/MRI (including the C/MRI User Manual), 
please see:</p>
<ul>
<li>The <a href="http://www.jlcenterprises.net/">JLC Enterprises web site</a>
<li>The <a href="https://groups.yahoo.com/neo/groups/CMRI_Users/info">C/MRI users Yahoo group</a> 
<li>The <a href="http://www.easeeinterfaces.com">Easee Interfaces web site</a>.
</ul>

<!--#include virtual="/Footer" -->
  </div><!-- closes #mainContent-->
 </div> <!-- closes #mBody-->
</body>
</html>
