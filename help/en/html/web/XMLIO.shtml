<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html lang="en">
<head>
<!-- Copyright 2008 -->
<!-- $Id: XMLIO.shtml,v 1.3 2010-02-14 06:10:00 jacobsen Exp $ -->
<title>JMRI: XML IO Servlet</title>

<!-- Style -->
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<link rel="stylesheet" type="text/css" href="/css/default.css" media="screen">
<link rel="stylesheet" type="text/css" href="/css/print.css" media="print">
<link rel="icon" href="/images/jmri.ico" TYPE="image/png">
<link rel="home" title="Home" href="/">
<!-- /Style -->
</head>

<body>
<!--#include virtual="/Header" -->

<!--#include virtual="Sidebar" -->
<div id="mainContent">

<h1> 
JMRI: XML IO Servlet
</h1>

The JMRI XML Servlet provides web access to JMRI services.

<p>
The servlet lives in the 
<a href="http://jmri.org/JavaDoc/doc/jmri/web/servlet/xmlio/package-summary.html">jmri.web.servlet.xmlio</a>
package, and provides web access to the
<a href="http://jmri.org/JavaDoc/doc/jmri/web/xmlio/package-summary.html">JMRI XML IO package</a>.
By default, the JMRI mini server will send any URL that starts with /xmlio to this servlet.

<p>
There are two sample pages that show how this can be used:
<dl>
<dt>web/request.xml
<dd>Makes a single XML request for all available sensors, and shows their status in a table.
<dt>web/monitor.xml
<dd>Uses delayed requests to monitor the status of all sensors, 
updating a table when any change.
</dl>

<p>
Please note that this servlet has only been used with 
the 
<a href="MiniServer.shtml">JMRI mini-server</a>, and may 
not work with other servlet containers.  We're committed to
making it work, however, so just get in touch with 
the JMRI developers if you encounter any problems.

<h2>Request Format</h2>

Here are some typical requests and responses.

<h3>Get the status of individual objects</h3>

Request:

<code><pre>
&lt;xmlio&gt;
  &lt;item&gt;
    &lt;type&gt;turnout&lt;/type&gt;
    &lt;name&gt;IT12&lt;/name&gt;
  &lt;/item&gt;
  &lt;item&gt;
    &lt;type&gt;sensor&lt;/type&gt;
    &lt;name&gt;West sensor&lt;/name&gt;
  &lt;/item&gt;
&lt;/xmlio&gt;
</pre></code>

Reply:
<code><pre>
&lt;xmlio&gt;
  &lt;item&gt;
    &lt;type&gt;turnout&lt;/type&gt;
    &lt;name&gt;IT12&lt;/name&gt;
    &lt;value&gt;2&lt;/value&gt;
  &lt;/item&gt;
  &lt;item&gt;
    &lt;type&gt;sensor&lt;/type&gt;
    &lt;name&gt;West sensor&lt;/name&gt;
    &lt;value&gt;4&lt;/value&gt;
  &lt;/item&gt;
&lt;/xmlio&gt;
</pre></code>

The "value" element is inserted in the request, and then it's 
returned as the reply.  You can just turn the reply around and use it 
as another request.  If "value" elements are present for all items,
the response will only be returned when one or more of the included
item's state has changed to something different.

<h3>Get all objects of a type</h3>

<code><pre>
&lt;xmlio&gt;
  &lt;list&gt;
    &lt;type&gt;sensor&lt;/type&gt;
  &lt;/list&gt;
&lt;/xmlio&gt;
</pre></code>

Reply:
<code><pre>
&lt;xmlio&gt;
  &lt;item&gt;
    &lt;type&gt;sensor&lt;/type&gt;
    &lt;name&gt;IS1&lt;/name&gt;
    &lt;value&gt;2&lt;/value&gt;
  &lt;/item&gt;
  &lt;item&gt;
    &lt;type&gt;sensor&lt;/type&gt;
    &lt;name&gt;IS2&lt;/name&gt;
    &lt;value&gt;4&lt;/value&gt;
  &lt;/item&gt;
  &lt;item&gt;
    &lt;type&gt;sensor&lt;/type&gt;
    &lt;name&gt;West sensor&lt;/name&gt;
    &lt;value&gt;2&lt;/value&gt;
  &lt;/item&gt;
&lt;/xmlio&gt;
</pre></code>

The response can be turned around and used as the next request.

<!--#include virtual="/Footer" -->
</body>
</html>
