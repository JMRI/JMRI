<?xml version="1.0"?>
<?xml-stylesheet type="text/xsl" href="../XSLT/decoder.xsl"?>
<!DOCTYPE decoder-config SYSTEM "../DTD/decoder-config.dtd">

<!-- Copyright (C) JMRI 2007, 2008 All rights reserved -->
<!-- $Id: Massoth_LGB_55027.xml,v 1.5 2008-02-03 18:40:48 jacobsen Exp $ -->
<!--                                                                        -->
<!-- JMRI is free software; you can redistribute it and/or modify it under  -->
<!-- the terms of version 2 of the GNU General Public License as published  -->
<!-- by the Free Software Foundation. See the "COPYING" file for a copy     -->
<!-- of this license.                                                       -->
<!--                                                                        -->
<!-- JMRI is distributed in the hope that it will be useful, but WITHOUT    -->
<!-- ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or  -->
<!-- FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License  -->
<!-- for more details.                                                      -->


<decoder-config>
		<version author="Jeff Schmaltz escopetas@comcast.net"
			version="1.1" lastUpdated="20080127" />
		<version author="Jeff Schmaltz escopetas@comcast.net"
			version="1.0" lastUpdated="20070204" />

<!-- 
      This decoder XML is meant to be used with the "Custom" programmer format.
      The pane definitions are included below the decoder definition.  The LGB
      decoders seem to fit the description of "weird" as mentioned in that
      programmer.  Also, this allows the tooltips from this decoder file to be
      displayed for the user.

      I'm afraid I have to admit that this decoder file has not been tested yet
      with a LGB 55027 decoder.  The XML has been checked with DecoderPro. It
      has been tested with a Massoth eMOTION XL Version 1.1.  While the two
      decoders are physically very different, based on the documents it appears
      that the firmware is very similar (if not identical).  I do feel that,
      based on this testing and my experience with the other LGB decoders, this
      55027 definition has a fair chance of being close to correct.

      The range of versions listed is hypothetical as the versions for all the
      Massoth/LGB decoder types overlap. The highest version I have encountered
      is 3.4 (in both large and small onboard) and the lowest is 1.0 (in a
      MTS I 55020).

      CV 106 is used by Massoth as "ID for decoder type" and is possibly one way
      of determining decoder type from the CV's, as the version numbers overlap.
      To date, I have encountered the following values in CV 106 (any additions to
      this list would be appreciated):

      55020:           10
      55021:           192
      55022:           16
      Small onboard:  65, 73, 81, 82, 83
      Large onboard:  129, 134, 145
      55027:           193
      eMOTION L:       201 (according to 1.0 manual)
      eMOTION XL:      193 (according to 1.2 manual), 200
      eMOTION XLS:     202 (according to 1.3 manual), 203
      eMOTION 8FL:     204 (according to 1.2 manual)
      LED Light:       204

      This definition was based on the LGB document for the 55027, dated 03/06, which
      is available from the LGB website.

      I tried to match DeccoderPro "item" names when I was fairly certain they were
      correct.  The "label" names tried to match the names used in the LGB
      documentation.

      Default values are from the 03/06 version of the instructions.

      Any and all feedback on this file would be appreciated.

      Version History:

        1.0 - pre-testing release 4 Feb 2007

        1.1 - 27 Jan 2008
              Cosmetic fix to one tool tip
              Cosmetic fix so XML would validate
              Added attributes to model element
              Removed high version
              Implemented "factReset"
              Added default values
              Corrected CV 60 max value
-->


<decoder>
	<family name="LGB" mfg="Massoth Elektronik, GmbH">
		<model model="LGB MTS III 55027 loco decoders" lowVersionID="10"
			maxInputVolts="24 V" maxMotorCurrent="3 A" maxTotalCurrent="4 A"
			numOuts="8" numFns="18"
			formFactor="G" connector="other" >
			<size length="55" width="25" height="12" units="mm" />
			<output name="1" label="Front light" maxcurrent="0.3 A" connection="wire" />
	   	 	<output name="2" label="Rear light " maxcurrent="0.3 A" connection="wire" />
	   	 	<output name="3" label="F1 " maxcurrent="0.3 A" connection="wire" />
	   	 	<output name="4" label="F2 " maxcurrent="0.3 A" connection="wire" />
	   	 	<output name="5" label="F3 " maxcurrent="0.3 A" connection="solder" />
	   	 	<output name="6" label="F4 " maxcurrent="0.3 A" connection="solder" />
	   	 	<output name="7" label="F5 " maxcurrent="0.3 A" connection="solder" />
	   	 	<output name="8" label="F6 " maxcurrent="0.3 A" connection="solder" />
		</model>
	</family>

	<programming direct="yes" paged="no"
	                     register="yes" ops="no"></programming>

	<variables> 

		<variable label="Loco address (standard short)" CV="1" default="3"
			item="Short Address"
			tooltip="Only if CV29, Bit5=0 Loco addresses 1- 23 for LGB MTS II, 1-127 for Dimax Navigator CV1" >
			<shortAddressVal/>
           	</variable>

		<variable label="Starting voltage" CV="2" default="2"
			item="Vstart"
			tooltip="CV2 x (1/255 track power) CV2">
			<decVal min="1" max="255"/>
		</variable>
		
		<variable label="Acceleration" CV="3" default="3"
			item="Accel"
			tooltip="CV3 x 2ms x (1/255 track power)- 1: rapid acceleration, 255: gradual acceleration CV3" >
			<decVal min="1" max="255"/>
		</variable>

		<variable label="Braking" CV="4" default="3"
			item="Decel"
			tooltip="CV4 x 2ms x (1/255 track power) - 1: rapid braking, 255: gradual braking) CV4" >
			<decVal min="1" max="255"/>
		</variable>
		
		<variable label="Maximum Speed" CV="5" default="255"
			item="Vhigh"
			tooltip="CV5 x (1/255 track power) CV5">
			<decVal min="1" max="255"/>
		</variable>
		
		<variable label="Medium Speed" CV="6" default="64"
			item="Vmid"
			tooltip="CV6 x (1/255 track power)CV6">
			<decVal min="1" max="255"/>
		</variable>

		<variable label="Software Version Number" CV="7"
			item="Decoder Version"
			tooltip="The decoder version number (read only) CV7" >
			<decVal/>
		</variable>

		<variable label="Manufacturer Code" CV="8" readOnly="yes" default="123"
			item="Manufacturer"
			tooltip="The manufacturer's ID number (read only) CV8">
			<decVal/>
		</variable>

		<variable label="Motor Frequency" CV="9" default="0"
			item="Total PWM Period"
			tooltip="Factory pre-set (16 kHz) is optimized for LGB motors. CV9">
			<enumVal>
				<enumChoice choice="16 kHz"/>
				<enumChoice choice="2 kHz"/>
				<enumChoice choice="0.4 kHz"/>
				<enumChoice choice="0.06 kHz"/>
			</enumVal>
		</variable>

		<variable label="F1 Function Output in Analog Mode" CV="13" mask="XXXXXXXV" default="1"
			item="Analog Mode Function Status - F1"
			tooltip="(On if value set) CV13">
			<enumVal>
				<enumChoice choice="Off"/>
				<enumChoice choice="On"/>
			</enumVal>
		</variable>
		<variable label="F2 Function Output in Analog Mode" CV="13" mask="XXXXXXVX" default="1"
			item="Analog Mode Function Status - F2"
			tooltip="(On if value set) CV13">
			<enumVal>
				<enumChoice choice="Off"/>
				<enumChoice choice="On"/>
			</enumVal>
		</variable>
		<variable label="F3 Function Output in Analog Mode" CV="13" mask="XXXXXVXX" default="0"
			item="Analog Mode Function Status - F3"
			tooltip="(On if value set) CV13">
			<enumVal>
				<enumChoice choice="Off"/>
				<enumChoice choice="On"/>
			</enumVal>
		</variable>
		<variable label="F4 Function Output in Analog Mode" CV="13" mask="XXXXVXXX" default="0"
			item="Analog Mode Function Status - F4"
			tooltip="(On if value set) CV13">
			<enumVal>
				<enumChoice choice="Off"/>
				<enumChoice choice="On"/>
			</enumVal>
		</variable>
		<variable label="F5 Function Output in Analog Mode" CV="13" mask="XXXVXXXX" default="0"
			item="Analog Mode Function Status - F5"
			tooltip="(On if value set) CV13">
			<enumVal>
				<enumChoice choice="Off"/>
				<enumChoice choice="On"/>
			</enumVal>
		</variable>
		<variable label="F6 Function Output in Analog Mode" CV="13" mask="XXVXXXXX" default="0"
			item="Analog Mode Function Status - F6"
			tooltip="(On if value set) CV13">
			<enumVal>
				<enumChoice choice="Off"/>
				<enumChoice choice="On"/>
			</enumVal>
		</variable>

		<variable label="Long Address" CV="17"
			item="Extended Address"
			tooltip="Sets the Extended 4 digit address (Range 128-10239) (not LGB MTS) CV17-18" >
			<longAddressVal/>
		</variable>

		<variable label="Normal direction of motion" CV="29" mask="XXXXXXXV" default="0"
			item="Locomotive Direction"
			tooltip="Sets the relative direction of the loco when told to move forward CV29" >
			<enumVal>
				<enumChoice choice="normal direction"/>
				<enumChoice choice="reversed direction"/>
			</enumVal>
		</variable>

		<variable label="Speed Steps" CV="29" mask="XXXXXXVX" default="0"
			item="Speed Step Mode"
			tooltip="Sets the speed step mode. 128 speed steps are recognized automatically CV29" >
			<enumVal>
				<enumChoice choice="14 speed steps (LGB MTS)"/>
				<enumChoice choice="28 speed steps (not for LGB)"/>
			</enumVal>
		</variable>

		<variable label="Analog conversion mode" CV="29" mask="XXXXXVXX" default="1"
			item="Analog (DC) Operation"
			tooltip="Determines whether loco can operate on conventional DC current (enables Power Source Conversion) CV29" >
			<enumVal>
				<enumChoice choice="digital operation only"/>
				<enumChoice choice="digital or analog"/>
			</enumVal>
		</variable>

		<variable label="Use Speed Table" CV="29" mask="XXXVXXXX" default="0"
			item="Speed Table Definition"
			tooltip="Determines whether loco will use manufacturer's internal or user-defined speed step table CV29" >
			<enumVal>
				<enumChoice choice="factory-programmed speed steps"/>
				<enumChoice choice="speed steps programmed by user (CV's 67-94)"/>
			</enumVal>
		</variable>

		<variable label="Addressing Mode" CV="29" mask="XXVXXXXX" default="0"
			item="Address Format"
			tooltip="Determines whether loco will use short or long address CV29" >
			<enumVal>
				<enumChoice choice="short loco address (CV 1)"/>
				<enumChoice choice="long loco address (CV17 + CV18)"/>
			</enumVal>
		</variable>

		<variable label="Function commands" CV="49" mask="XXXXXXXV" default="1"
			tooltip="When serial is selected, F1 - F8 also can be triggered parallel. CV49" >
			<enumVal>
				<enumChoice choice="parallel"/>
				<enumChoice choice="serial"/>
			</enumVal>
		</variable>

		<variable label="Digital Back-EMF" CV="49" mask="XXXXXXVX" default="1"
			tooltip="Back-EMF keeps the loco speed constant even as the load varies. CV49" >
			<enumVal>
				<enumChoice choice="off"/>
				<enumChoice choice="on"/>
			</enumVal>
		</variable>

		<variable label="Analog Back-EMF" CV="49" mask="XXXXXVXX" default="1"
			tooltip="Back-EMF keeps the loco speed constant even as the load varies. CV49" >
			<enumVal>
				<enumChoice choice="off"/>
				<enumChoice choice="on"/>
			</enumVal>
		</variable>

		<variable label="Interface" CV="49" mask="XXXXVXXX" default="0"
			tooltip="If old LGB interface is selected, serial function commands must be selected as well. CV49" >
			<enumVal>
				<enumChoice choice="no interface or DCC interface"/>
				<enumChoice choice="old LGB interface for 55020/21"/>
			</enumVal>
		</variable>

		<variable label="Voltage for lights" CV="50" default="32"
			tooltip="Locos with interface = 32(full track power); direct connection of 5V bulbs = 5; direct connection of 19V bulbs = 26. CV50">
			<decVal min="1" max="32"/>
		</variable>

		<variable label="Command for front light - Direction" CV="51" mask="VVXXXXXX" default="2"
			tooltip="Direction for front light On CV51">
			<enumVal>
				<enumChoice choice="Front Light On in both directions" value="0"/>
				<enumChoice choice="Front Light On in Reverse only" value="1"/>
				<enumChoice choice="Front Light On in Standard Driving Direction only" value="2"/>
			</enumVal>
		</variable>

		<variable label="Command for front light - Function Keys" CV="51" mask="XXXVVVVV" default="0"
			tooltip="Function key which switches front light (MTS II buttons 1-8 only) CV51">
			<enumVal>
				<enumChoice choice="Light Key" value="0"/>
				<enumChoice choice="F1" value="1"/>
				<enumChoice choice="F2" value="2"/>
				<enumChoice choice="F3" value="3"/>
				<enumChoice choice="F4" value="4"/>
				<enumChoice choice="F5" value="5"/>
				<enumChoice choice="F6" value="6"/>
				<enumChoice choice="F7" value="7"/>
				<enumChoice choice="F8" value="8"/>
				<enumChoice choice="F9" value="9"/>
				<enumChoice choice="F10" value="10"/>
				<enumChoice choice="F11" value="11"/>
				<enumChoice choice="F12" value="12"/>
				<enumChoice choice="F13" value="13"/>
				<enumChoice choice="F14" value="14"/>
				<enumChoice choice="F15" value="15"/>
				<enumChoice choice="F16" value="16"/>
			</enumVal>
		</variable>

		<variable label="Command for rear light - Direction" CV="52" mask="VVXXXXXX" default="1"
			tooltip="Direction for rear light On CV52">
			<enumVal>
				<enumChoice choice="Rear Light On in both directions" value="0"/>
				<enumChoice choice="Rear Light On in Reverse only" value="1"/>
				<enumChoice choice="Rear Light On in Standard Driving Direction only" value="2"/>
			</enumVal>
		</variable>

		<variable label="Command for rear light - Function Keys" CV="52" mask="XXXVVVVV" default="0"
			tooltip="Function key which switches rear light (MTS II buttons 1-8 only) CV52">
			<enumVal>
				<enumChoice choice="Light Key" value="0"/>
				<enumChoice choice="F1" value="1"/>
				<enumChoice choice="F2" value="2"/>
				<enumChoice choice="F3" value="3"/>
				<enumChoice choice="F4" value="4"/>
				<enumChoice choice="F5" value="5"/>
				<enumChoice choice="F6" value="6"/>
				<enumChoice choice="F7" value="7"/>
				<enumChoice choice="F8" value="8"/>
				<enumChoice choice="F9" value="9"/>
				<enumChoice choice="F10" value="10"/>
				<enumChoice choice="F11" value="11"/>
				<enumChoice choice="F12" value="12"/>
				<enumChoice choice="F13" value="13"/>
				<enumChoice choice="F14" value="14"/>
				<enumChoice choice="F15" value="15"/>
				<enumChoice choice="F16" value="16"/>
			</enumVal>
		</variable>

		<variable label="F1 + F2: Voltage" CV="53" mask="XXVVVVVV" default="32"
			tooltip="32 = full track voltage CV53">
			<decVal min="1" max="32"/>
		</variable>

		<variable label="F1 + F2: Voltage: Select Function to be Dimmed" CV="53" mask="VVXXXXXX" default="0"
			tooltip="Which function or functions is dimmed CV53">
			<enumVal>
				<enumChoice choice="Full voltage on both outputs" value="0"/>
				<enumChoice choice="Only voltage for F1 is adjusted" value="1"/>
				<enumChoice choice="Only voltage for F2 is adjusted" value="2"/>
				<enumChoice choice="Voltage for both F1 and F2 is adjusted" value="3"/>
			</enumVal>
		</variable>

		<variable label="Command for F1 - Direction" CV="54" mask="VVXXXXXX" default="0"
			tooltip="Direction for F1 On CV54">
			<enumVal>
				<enumChoice choice="F1 On in both directions" value="0"/>
				<enumChoice choice="F1 On in Reverse only" value="1"/>
				<enumChoice choice="F1 On in Standard Driving Direction only" value="2"/>
			</enumVal>
		</variable>

		<variable label="Command for F1 - Function Keys" CV="54" mask="XXXVVVVV" default="1"
			tooltip="Function key which switches F1 (MTS II buttons 1-8 only) CV54">
			<enumVal>
				<enumChoice choice="Light Key" value="0"/>
				<enumChoice choice="F1" value="1"/>
				<enumChoice choice="F2" value="2"/>
				<enumChoice choice="F3" value="3"/>
				<enumChoice choice="F4" value="4"/>
				<enumChoice choice="F5" value="5"/>
				<enumChoice choice="F6" value="6"/>
				<enumChoice choice="F7" value="7"/>
				<enumChoice choice="F8" value="8"/>
				<enumChoice choice="F9" value="9"/>
				<enumChoice choice="F10" value="10"/>
				<enumChoice choice="F11" value="11"/>
				<enumChoice choice="F12" value="12"/>
				<enumChoice choice="F13" value="13"/>
				<enumChoice choice="F14" value="14"/>
				<enumChoice choice="F15" value="15"/>
				<enumChoice choice="F16" value="16"/>
			</enumVal>
		</variable>

		<variable label="F1: Special Function: Blinking/Monoflop time base" CV="55" mask="XXXXVVVV" default="0"
			tooltip="0=Steady On (Standard Operation), 1..15=Blinking/Monoflop Time Base 0.25sec per value CV55">
			<enumVal>
				<enumChoice choice="Steady On (Standard Operation)" value="0"/>
				<enumChoice choice="0.25 sec" value="1"/>
				<enumChoice choice="0.50 sec" value="2"/>
				<enumChoice choice="0.75 sec" value="3"/>
				<enumChoice choice="1.00 sec" value="4"/>
				<enumChoice choice="1.25 sec" value="5"/>
				<enumChoice choice="1.50 sec" value="6"/>
				<enumChoice choice="1.75 sec" value="7"/>
				<enumChoice choice="2.00 sec" value="8"/>
				<enumChoice choice="2.25 sec" value="9"/>
				<enumChoice choice="2.50 sec" value="10"/>
				<enumChoice choice="2.75 sec" value="11"/>
				<enumChoice choice="3.00 sec" value="12"/>
				<enumChoice choice="3.25 sec" value="13"/>
				<enumChoice choice="3.50 sec" value="14"/>
				<enumChoice choice="3.75 sec" value="15"/>
			</enumVal>
		</variable>

		<variable label="F1: Special Function: Select Special Function" CV="55" mask="VVXXXXXX" default="0"
			tooltip="Which special function, if any, for F1. For Monoflop, output is switched off automatically after timeout. CV55">
			<enumVal>
				<enumChoice choice="Symmetric Blinking" value="0"/>
				<enumChoice choice="Short Term Function (Monoflop)" value="1"/>
				<enumChoice choice="Asymmetric Blinking (Short), Output blinks 1/3 On" value="2"/>
				<enumChoice choice="Asymmetric Blinking (Long), Output blinks 2/3 On" value="3"/>
			</enumVal>
		</variable>

                <!-- NOTE: in eMOTION manual, inverse coupling of F1 and F2 is CV 57 not 55 -->
		<variable label="F1: Inverse coupling of F1 and F2 terminals" CV="55" mask="XXXVXXXX" default="0"
			tooltip="Activate inverse coupling, usually alternate blinking, with F2 CV55">
			<enumVal>
				<enumChoice choice="Off" value="0"/>
				<enumChoice choice="On" value="1"/>
			</enumVal>
		</variable>

		<variable label="Command for F2 - Direction" CV="56" mask="VVXXXXXX" default="0"
			tooltip="Direction for F2 On CV56">
			<enumVal>
				<enumChoice choice="F2 On in both directions" value="0"/>
				<enumChoice choice="F2 On in Reverse only" value="1"/>
				<enumChoice choice="F2 On in Standard Driving Direction only" value="2"/>
			</enumVal>
		</variable>

		<variable label="Command for F2 - Function Keys" CV="56" mask="XXXVVVVV" default="2"
			tooltip="Function key which switches F2 (MTS II buttons 1-8 only) CV56">
			<enumVal>
				<enumChoice choice="Light Key" value="0"/>
				<enumChoice choice="F1" value="1"/>
				<enumChoice choice="F2" value="2"/>
				<enumChoice choice="F3" value="3"/>
				<enumChoice choice="F4" value="4"/>
				<enumChoice choice="F5" value="5"/>
				<enumChoice choice="F6" value="6"/>
				<enumChoice choice="F7" value="7"/>
				<enumChoice choice="F8" value="8"/>
				<enumChoice choice="F9" value="9"/>
				<enumChoice choice="F10" value="10"/>
				<enumChoice choice="F11" value="11"/>
				<enumChoice choice="F12" value="12"/>
				<enumChoice choice="F13" value="13"/>
				<enumChoice choice="F14" value="14"/>
				<enumChoice choice="F15" value="15"/>
				<enumChoice choice="F16" value="16"/>
			</enumVal>
		</variable>

		<variable label="F2: Special Function: Blinking/Monoflop time base" CV="57" mask="XXXXVVVV" default="0"
			tooltip="0=Steady On (Standard Operation), 1..15=Blinking/Monoflop Time Base 0.25sec per value CV57">
			<enumVal>
				<enumChoice choice="Steady On (Standard Operation)" value="0"/>
				<enumChoice choice="0.25 sec" value="1"/>
				<enumChoice choice="0.50 sec" value="2"/>
				<enumChoice choice="0.75 sec" value="3"/>
				<enumChoice choice="1.00 sec" value="4"/>
				<enumChoice choice="1.25 sec" value="5"/>
				<enumChoice choice="1.50 sec" value="6"/>
				<enumChoice choice="1.75 sec" value="7"/>
				<enumChoice choice="2.00 sec" value="8"/>
				<enumChoice choice="2.25 sec" value="9"/>
				<enumChoice choice="2.50 sec" value="10"/>
				<enumChoice choice="2.75 sec" value="11"/>
				<enumChoice choice="3.00 sec" value="12"/>
				<enumChoice choice="3.25 sec" value="13"/>
				<enumChoice choice="3.50 sec" value="14"/>
				<enumChoice choice="3.75 sec" value="15"/>
			</enumVal>
		</variable>

		<variable label="F2: Special Function: Select Special Function" CV="57" mask="VVXXXXXX" default="0"
			tooltip="Which special function, if any, for F2. For Monoflop, output is switched off automatically after timeout. CV57">
			<enumVal>
				<enumChoice choice="Symmetric Blinking" value="0"/>
				<enumChoice choice="Short Term Function (Monoflop)" value="1"/>
				<enumChoice choice="Asymmetric Blinking (Short), Output blinks 1/3 On" value="2"/>
				<enumChoice choice="Asymmetric Blinking (Long), Output blinks 2/3 On" value="3"/>
			</enumVal>
		</variable>

		<variable label="Pause time when stopping and changing direction" CV="58" default="0"
			tooltip="Pause equals programmed value x 0.5 seconds CV58">
			<decVal min="0" max="255"/>
		</variable>

		<variable label="Half-speed mode" CV="59" default="8"
			item="Half-speed mode"
			tooltip="Command which triggers the Half-speed mode (MTS II buttons 1-8 only) CV59" >
			<enumVal>
                                <!-- 0 equals "off" is guess based on eMOTION XL document/behavior -->
				<enumChoice choice="Half Speed Off" value="0"/>
				<enumChoice choice="button 1" value="1"/>
				<enumChoice choice="button 2" value="2"/>
				<enumChoice choice="button 3" value="3"/>
				<enumChoice choice="button 4" value="4"/>
				<enumChoice choice="button 5" value="5"/>
				<enumChoice choice="button 6" value="6"/>
				<enumChoice choice="button 7" value="7"/>
				<enumChoice choice="button 8" value="8"/>
				<enumChoice choice="button 9" value="9"/>
				<enumChoice choice="button 10" value="10"/>
				<enumChoice choice="button 11" value="11"/>
				<enumChoice choice="button 12" value="12"/>
				<enumChoice choice="button 13" value="13"/>
				<enumChoice choice="button 14" value="14"/>
				<enumChoice choice="button 15" value="15"/>
				<enumChoice choice="button 16" value="16"/>
			</enumVal>
		</variable>

		<variable label="Back-EMF Maximum Adjustment Factor" CV="60" default="2"
			tooltip="Large value = large adjustment CV60">
			<decVal min="1" max="255"/>
		</variable>

		<variable label="Back-EMF Adjustment Frequency" CV="61" default="60"
			tooltip="Large value = slow reaction CV61">
			<decVal min="1" max="255"/>
		</variable>

		<variable label="Back-EMF Maximum Adjustment" CV="62" default="255"
			tooltip="255 = no limit CV62">
			<decVal min="1" max="255"/>
		</variable>

		<variable label="Speed Table" CV="67">
			<speedTableVal>
				<speedTableEntry step="1" value="8"/>
				<speedTableEntry step="2" value="16"/>
				<speedTableEntry step="3" value="24"/>
				<speedTableEntry step="4" value="32"/>
				<speedTableEntry step="5" value="40"/>
				<speedTableEntry step="6" value="48"/>
				<speedTableEntry step="7" value="56"/>
				<speedTableEntry step="8" value="64"/>
				<speedTableEntry step="9" value="72"/>
				<speedTableEntry step="10" value="80"/>
				<speedTableEntry step="11" value="88"/>
				<speedTableEntry step="12" value="96"/>
				<speedTableEntry step="13" value="104"/>
				<speedTableEntry step="14" value="112"/>
				<speedTableEntry step="15" value="120"/>
				<speedTableEntry step="16" value="128"/>
				<speedTableEntry step="17" value="136"/>
				<speedTableEntry step="18" value="144"/>
				<speedTableEntry step="19" value="152"/>
				<speedTableEntry step="20" value="160"/>
				<speedTableEntry step="21" value="168"/>
				<speedTableEntry step="22" value="176"/>
				<speedTableEntry step="23" value="184"/>
				<speedTableEntry step="24" value="192"/>
				<speedTableEntry step="25" value="208"/>
				<speedTableEntry step="26" value="224"/>
				<speedTableEntry step="27" value="240"/>
				<speedTableEntry step="28" value="255"/>
			</speedTableVal>
		</variable>

		<!-- Do not attempt to read CV 105 on an LGB decoder -->

		<variable label="ID for Decoder Type" CV="106" readOnly="yes"
			item="Decoder Type"
			tooltip="ID for Decoder Type (read only) CV106">
			<decVal/>
		</variable>

		<variable label="F3 + F4: Voltage" CV="112" mask="XXVVVVVV" default="32"
			tooltip="32 = full track voltage CV112">
			<decVal min="1" max="32"/>
		</variable>

		<variable label="F3 + F4: Voltage: Select Function to be Dimmed" CV="112" mask="VVXXXXXX" default="0"
			tooltip="Which function or functions is dimmed CV112">
			<enumVal>
				<enumChoice choice="Full voltage on both outputs" value="0"/>
				<enumChoice choice="Only voltage for F3 is adjusted" value="1"/>
				<enumChoice choice="Only voltage for F4 is adjusted" value="2"/>
				<enumChoice choice="Voltage for both F3 and F4 is adjusted" value="3"/>
			</enumVal>
		</variable>

		<variable label="Command for F3 - Direction" CV="113" mask="VVXXXXXX" default="0"
			tooltip="Direction for F3 On CV113">
			<enumVal>
				<enumChoice choice="F3 On in both directions" value="0"/>
				<enumChoice choice="F3 On in Reverse only" value="1"/>
				<enumChoice choice="F3 On in Standard Driving Direction only" value="2"/>
			</enumVal>
		</variable>

		<variable label="Command for F3 - Function Keys" CV="113" mask="XXXVVVVV" default="3"
			tooltip="Function key which switches F3 (MTS II buttons 1-8 only) CV113">
			<enumVal>
				<enumChoice choice="Light Key" value="0"/>
				<enumChoice choice="F1" value="1"/>
				<enumChoice choice="F2" value="2"/>
				<enumChoice choice="F3" value="3"/>
				<enumChoice choice="F4" value="4"/>
				<enumChoice choice="F5" value="5"/>
				<enumChoice choice="F6" value="6"/>
				<enumChoice choice="F7" value="7"/>
				<enumChoice choice="F8" value="8"/>
				<enumChoice choice="F9" value="9"/>
				<enumChoice choice="F10" value="10"/>
				<enumChoice choice="F11" value="11"/>
				<enumChoice choice="F12" value="12"/>
				<enumChoice choice="F13" value="13"/>
				<enumChoice choice="F14" value="14"/>
				<enumChoice choice="F15" value="15"/>
				<enumChoice choice="F16" value="16"/>
			</enumVal>
		</variable>

		<variable label="F3: Special Function: Blinking/Monoflop time base" CV="114" mask="XXXXVVVV" default="0"
			tooltip="0=Steady On (Standard Operation), 1..15=Blinking/Monoflop Time Base 0.25sec per value CV114">
			<enumVal>
				<enumChoice choice="Steady On (Standard Operation)" value="0"/>
				<enumChoice choice="0.25 sec" value="1"/>
				<enumChoice choice="0.50 sec" value="2"/>
				<enumChoice choice="0.75 sec" value="3"/>
				<enumChoice choice="1.00 sec" value="4"/>
				<enumChoice choice="1.25 sec" value="5"/>
				<enumChoice choice="1.50 sec" value="6"/>
				<enumChoice choice="1.75 sec" value="7"/>
				<enumChoice choice="2.00 sec" value="8"/>
				<enumChoice choice="2.25 sec" value="9"/>
				<enumChoice choice="2.50 sec" value="10"/>
				<enumChoice choice="2.75 sec" value="11"/>
				<enumChoice choice="3.00 sec" value="12"/>
				<enumChoice choice="3.25 sec" value="13"/>
				<enumChoice choice="3.50 sec" value="14"/>
				<enumChoice choice="3.75 sec" value="15"/>
			</enumVal>
		</variable>

		<variable label="F3: Special Function: Select Special Function" CV="114" mask="VVXXXXXX" default="0"
			tooltip="Which special function, if any, for F3. For Monoflop, output is switched off automatically after timeout. CV114">
			<enumVal>
				<enumChoice choice="Symmetric Blinking" value="0"/>
				<enumChoice choice="Short Term Function (Monoflop)" value="1"/>
				<enumChoice choice="Asymmetric Blinking (Short), Output blinks 1/3 On" value="2"/>
				<enumChoice choice="Asymmetric Blinking (Long), Output blinks 2/3 On" value="3"/>
			</enumVal>
		</variable>

                <!-- NOTE: in eMOTION manual, inverse coupling of F3 and F4 is CV 116 not 114 -->
		<variable label="F3: Inverse coupling of F3 and F4 terminals" CV="114" mask="XXXVXXXX" default="0"
			tooltip="Activate inverse coupling, usually alternate blinking, with F4 CV114">
			<enumVal>
				<enumChoice choice="Off" value="0"/>
				<enumChoice choice="On" value="1"/>
			</enumVal>
		</variable>

		<variable label="Command for F4 - Direction" CV="115" mask="VVXXXXXX" default="0"
			tooltip="Direction for F4 On CV115">
			<enumVal>
				<enumChoice choice="F4 On in both directions" value="0"/>
				<enumChoice choice="F4 On in Reverse only" value="1"/>
				<enumChoice choice="F4 On in Standard Driving Direction only" value="2"/>
			</enumVal>
		</variable>

		<variable label="Command for F4 - Function Keys" CV="115" mask="XXXVVVVV" default="4"
			tooltip="Function key which switches F4 (MTS II buttons 1-8 only) CV115">
			<enumVal>
				<enumChoice choice="Light Key" value="0"/>
				<enumChoice choice="F1" value="1"/>
				<enumChoice choice="F2" value="2"/>
				<enumChoice choice="F3" value="3"/>
				<enumChoice choice="F4" value="4"/>
				<enumChoice choice="F5" value="5"/>
				<enumChoice choice="F6" value="6"/>
				<enumChoice choice="F7" value="7"/>
				<enumChoice choice="F8" value="8"/>
				<enumChoice choice="F9" value="9"/>
				<enumChoice choice="F10" value="10"/>
				<enumChoice choice="F11" value="11"/>
				<enumChoice choice="F12" value="12"/>
				<enumChoice choice="F13" value="13"/>
				<enumChoice choice="F14" value="14"/>
				<enumChoice choice="F15" value="15"/>
				<enumChoice choice="F16" value="16"/>
			</enumVal>
		</variable>

		<variable label="F4: Special Function: Blinking/Monoflop time base" CV="116" mask="XXXXVVVV" default="0"
			tooltip="0=Steady On (Standard Operation), 1..15=Blinking/Monoflop Time Base 0.25sec per value CV116">
			<enumVal>
				<enumChoice choice="Steady On (Standard Operation)" value="0"/>
				<enumChoice choice="0.25 sec" value="1"/>
				<enumChoice choice="0.50 sec" value="2"/>
				<enumChoice choice="0.75 sec" value="3"/>
				<enumChoice choice="1.00 sec" value="4"/>
				<enumChoice choice="1.25 sec" value="5"/>
				<enumChoice choice="1.50 sec" value="6"/>
				<enumChoice choice="1.75 sec" value="7"/>
				<enumChoice choice="2.00 sec" value="8"/>
				<enumChoice choice="2.25 sec" value="9"/>
				<enumChoice choice="2.50 sec" value="10"/>
				<enumChoice choice="2.75 sec" value="11"/>
				<enumChoice choice="3.00 sec" value="12"/>
				<enumChoice choice="3.25 sec" value="13"/>
				<enumChoice choice="3.50 sec" value="14"/>
				<enumChoice choice="3.75 sec" value="15"/>
			</enumVal>
		</variable>

		<variable label="F4: Special Function: Select Special Function" CV="116" mask="VVXXXXXX" default="0"
			tooltip="Which special function, if any, for F4. For Monoflop, output is switched off automatically after timeout. CV116">
			<enumVal>
				<enumChoice choice="Symmetric Blinking" value="0"/>
				<enumChoice choice="Short Term Function (Monoflop)" value="1"/>
				<enumChoice choice="Asymmetric Blinking (Short), Output blinks 1/3 On" value="2"/>
				<enumChoice choice="Asymmetric Blinking (Long), Output blinks 2/3 On" value="3"/>
			</enumVal>
		</variable>

		<variable label="Command for F5 - Direction" CV="117" mask="VVXXXXXX" default="0"
			tooltip="Direction for F5 On CV117">
			<enumVal>
				<enumChoice choice="F5 On in both directions" value="0"/>
				<enumChoice choice="F5 On in Reverse only" value="1"/>
				<enumChoice choice="F5 On in Standard Driving Direction only" value="2"/>
			</enumVal>
		</variable>

		<variable label="Command for F5 - Function Keys" CV="117" mask="XXXVVVVV" default="5"
			tooltip="Function key which switches F5 (MTS II buttons 1-8 only) CV117">
			<enumVal>
				<enumChoice choice="Light Key" value="0"/>
				<enumChoice choice="F1" value="1"/>
				<enumChoice choice="F2" value="2"/>
				<enumChoice choice="F3" value="3"/>
				<enumChoice choice="F4" value="4"/>
				<enumChoice choice="F5" value="5"/>
				<enumChoice choice="F6" value="6"/>
				<enumChoice choice="F7" value="7"/>
				<enumChoice choice="F8" value="8"/>
				<enumChoice choice="F9" value="9"/>
				<enumChoice choice="F10" value="10"/>
				<enumChoice choice="F11" value="11"/>
				<enumChoice choice="F12" value="12"/>
				<enumChoice choice="F13" value="13"/>
				<enumChoice choice="F14" value="14"/>
				<enumChoice choice="F15" value="15"/>
				<enumChoice choice="F16" value="16"/>
			</enumVal>
		</variable>

		<variable label="F5: Special Function: Blinking/Monoflop time base" CV="118" mask="XXXXVVVV" default="2"
			tooltip="0=Steady On (Standard Operation), 1..15=Blinking/Monoflop Time Base 0.25sec per value CV118">
			<enumVal>
				<enumChoice choice="Steady On (Standard Operation)" value="0"/>
				<enumChoice choice="0.25 sec" value="1"/>
				<enumChoice choice="0.50 sec" value="2"/>
				<enumChoice choice="0.75 sec" value="3"/>
				<enumChoice choice="1.00 sec" value="4"/>
				<enumChoice choice="1.25 sec" value="5"/>
				<enumChoice choice="1.50 sec" value="6"/>
				<enumChoice choice="1.75 sec" value="7"/>
				<enumChoice choice="2.00 sec" value="8"/>
				<enumChoice choice="2.25 sec" value="9"/>
				<enumChoice choice="2.50 sec" value="10"/>
				<enumChoice choice="2.75 sec" value="11"/>
				<enumChoice choice="3.00 sec" value="12"/>
				<enumChoice choice="3.25 sec" value="13"/>
				<enumChoice choice="3.50 sec" value="14"/>
				<enumChoice choice="3.75 sec" value="15"/>
			</enumVal>
		</variable>

		<variable label="F5: Special Function: Select Special Function" CV="118" mask="VVXXXXXX" default="1"
			tooltip="Which special function, if any, for F5. For Monoflop, output is switched off automatically after timeout. CV118">
			<enumVal>
				<enumChoice choice="Symmetric Blinking" value="0"/>
				<enumChoice choice="Short Term Function (Monoflop)" value="1"/>
				<enumChoice choice="Asymmetric Blinking (Short), Output blinks 1/3 On" value="2"/>
				<enumChoice choice="Asymmetric Blinking (Long), Output blinks 2/3 On" value="3"/>
			</enumVal>
		</variable>

		<variable label="Command for F6 - Direction" CV="119" mask="VVXXXXXX" default="0"
			tooltip="Direction for F6 On CV119">
			<enumVal>
				<enumChoice choice="F6 On in both directions" value="0"/>
				<enumChoice choice="F6 On in Reverse only" value="1"/>
				<enumChoice choice="F6 On in Standard Driving Direction only" value="2"/>
			</enumVal>
		</variable>

		<variable label="Command for F6 - Function Keys" CV="119" mask="XXXVVVVV" default="6"
			tooltip="Function key which switches F6 (MTS II buttons 1-8 only) CV119">
			<enumVal>
				<enumChoice choice="Light Key" value="0"/>
				<enumChoice choice="F1" value="1"/>
				<enumChoice choice="F2" value="2"/>
				<enumChoice choice="F3" value="3"/>
				<enumChoice choice="F4" value="4"/>
				<enumChoice choice="F5" value="5"/>
				<enumChoice choice="F6" value="6"/>
				<enumChoice choice="F7" value="7"/>
				<enumChoice choice="F8" value="8"/>
				<enumChoice choice="F9" value="9"/>
				<enumChoice choice="F10" value="10"/>
				<enumChoice choice="F11" value="11"/>
				<enumChoice choice="F12" value="12"/>
				<enumChoice choice="F13" value="13"/>
				<enumChoice choice="F14" value="14"/>
				<enumChoice choice="F15" value="15"/>
				<enumChoice choice="F16" value="16"/>
			</enumVal>
		</variable>

		<variable label="F6: Special Function: Time Base for Sound Pulse Generator" CV="120" mask="XXXXVVVV" default="8"
			tooltip="0=Steady On (Standard Operation), 1..15=Timing for sound cam simulator (1=slow, 15=fast CV120">
			<decVal min="0" max="15"/>
		</variable>

	</variables>

        <resets>
		<factReset label="Reset basic settings" CV="7" default="55"/>
		<factReset label="Reset motor settings" CV="7" default="66"/>
		<factReset label="Reset lights and functions" CV="7" default="77"/>
        </resets>

</decoder>

<pane name="Basic">
		<column>
			<dccaddress />
			<label label=" "/>
			<display item="Short Address" />
			<display item="Extended Address" />
			<display item="Address Format" />
			<label label=" "/>
			<display item="Locomotive Direction" />
			<display item="Speed Step Mode" />
			<display item="Analog (DC) Operation" />
		</column>
		<column>
			<label label=" "/>
			<label label=" "/>
			<label label=" "/>
			<label label=" "/>
			<label label=" "/>
			<separator/>
			<label label=" "/>
			<display item="Manufacturer" />
			<display item="Decoder Version" />
			<display item="Decoder Type" />
		</column>
	</pane>

	<pane name="Motor">
		<column>
			<display item="Accel" />
			<display item="Decel" />
			<label label=" "/>
			<display item="Total PWM Period" />
			<label label=" "/>
			<display item="Pause time when stopping and changing direction" />
			<label label=" "/>
			<display item="Digital Back-EMF"/>
			<display item="Analog Back-EMF"/>
			<label label=" "/>
			<display item="Back-EMF Maximum Adjustment Factor"/>
			<display item="Back-EMF Adjustment Frequency"/>
			<display item="Back-EMF Maximum Adjustment"/>
		</column>
	</pane>

	<pane name="Speed Control">
		<column>
			<row>
				<column>
					<label label=" "/>
					<display item="Vstart" />
					<display item="Vmid" />
					<display item="Vhigh" />
					<label label=" "/>
				</column>
				<column>
					<display item="Vstart" format="hslider" label="" />
					<display item="Vmid" format="hslider" label="" />
					<display item="Vhigh" format="hslider" label="" />
				</column>
			</row>
			<separator/>
			<row>
				<column>
					<label label=" "/>
					<display item="Speed Table Definition"
						format="offradiobutton" label=""/>
					<label label=" "/>
				</column>
			</row>
			<row>
				<column>
					<display item="Speed Table Definition"
						format="onradiobutton" layout="above" label=""/>
				</column>
			</row>
			<row>
				<column>
					<label label=" "/>
					<display item="Speed Table Selection" />
				</column>
			</row>
			<row>
			  <column>
					<display item="Speed Table" layout="above"/>
					<label label=" "/>
				</column>
			</row>
		</column>
	</pane>

	<pane name="Lights and Functions">
		<column>
			<display item="Voltage for lights"/>
			<display item="Command for front light - Direction"/>
			<display item="Command for front light - Function Keys"/>
			<display item="Command for rear light - Direction"/>
			<display item="Command for rear light - Function Keys"/>
			<label label=" "/>
			<display item="Command for F1 - Direction"/>
			<display item="Command for F1 - Function Keys"/>
			<display item="F1: Special Function: Blinking/Monoflop time base"/>
			<display item="F1: Special Function: Select Special Function"/>
			<label label=" "/>
			<display item="F1 + F2: Voltage"/>
			<display item="F1 + F2: Voltage: Select Function to be Dimmed"/>
			<display item="F1: Inverse coupling of F1 and F2 terminals"/>
			<label label=" "/>
			<display item="Command for F2 - Direction"/>
			<display item="Command for F2 - Function Keys"/>
			<display item="F2: Special Function: Blinking/Monoflop time base"/>
			<display item="F2: Special Function: Select Special Function"/>
			<label label=" "/>
			<display item="Command for F3 - Direction"/>
			<display item="Command for F3 - Function Keys"/>
			<display item="F3: Special Function: Blinking/Monoflop time base"/>
			<display item="F3: Special Function: Select Special Function"/>
			<label label=" "/>
			<display item="F3 + F4: Voltage"/>
			<display item="F3 + F4: Voltage: Select Function to be Dimmed"/>
			<display item="F3: Inverse coupling of F3 and F4 terminals"/>
			<label label=" "/>
			<display item="Command for F4 - Direction"/>
			<display item="Command for F4 - Function Keys"/>
			<display item="F4: Special Function: Blinking/Monoflop time base"/>
			<display item="F4: Special Function: Select Special Function"/>
			<label label=" "/>
			<display item="Command for F5 - Direction"/>
			<display item="Command for F5 - Function Keys"/>
			<display item="F5: Special Function: Blinking/Monoflop time base"/>
			<display item="F5: Special Function: Select Special Function"/>
			<label label=" "/>
			<display item="Command for F6 - Direction"/>
			<display item="Command for F6 - Function Keys"/>
			<display item="F6: Special Function: Time Base for Sound Pulse Generator"/>
		</column>
	</pane>

	<pane name="Analog Controls">
        	<column>
			<display item="Analog (DC) Operation" />	
		</column>
		<column>
			<display item="Analog Mode Function Status - F1" format="checkbox" />
			<display item="Analog Mode Function Status - F2" format="checkbox" />
			<display item="Analog Mode Function Status - F3" format="checkbox" />
			<display item="Analog Mode Function Status - F4" format="checkbox" />
			<display item="Analog Mode Function Status - F5" format="checkbox" />
			<display item="Analog Mode Function Status - F6" format="checkbox" />
		</column>
	</pane>

	<pane name="Miscellaneous">
		<column>
			<row>
				<column>
					<display item="Half-speed mode"/>
					<label label=" "/>
					<label label=" "/>
					<label label=" "/>
				</column>
			</row>
			<row>
				<column>
					<label label="LGB configuration"/>
					<separator />
					<label label=" "/>
					<display item="Function commands"/>
					<display item="Interface"/>
				</column>
			</row>
		</column>
	</pane>

	<pane name="CVs">
		<column>
			<cvtable/>
		</column>
	</pane>

</decoder-config>
