<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<!-- $Id: Addressing.html,v 1.4 2005-04-11 21:11:56 jacobsen Exp $ -->
<html lang="en">
<head>
    <TITLE>
 	JMRI: LocoNet Addressing
    </TITLE>
    <META content="Bob Jacobsen" name=Author>
    <meta name="keywords" content="JMRI LocoNet Address Addressing Sensors Turnout">

    <!-- The combination of "Define" and {Header,Style, Logo and Footer} comments -->
    <!-- are an arbitrary design pattern used by the update.pl script to -->
    <!-- easily replace the common header/footer code for all the web pages -->

<!-- Style -->
  <META http-equiv=Content-Type content="text/html; charset=iso-8859-1">
  <link rel="stylesheet" type="text/css" href="/css/default.css" media="screen">
  <link rel="stylesheet" type="text/css" href="/css/print.css" media="print">
  <link rel="icon" href="/images/jmri.ico" type="image/png">
  <link rel="home" title="Home" href="/">
<!-- /Style -->
</head>

<body>
    <p class="skipLink"><a href="#mainContent" accesskey="2">Skip to main content</a></p>

<!-- Header -->
    <div id="header">
	<!-- Logo -->
	<a href="/" title="Return to home page" accesskey="1">
	    <img src="/images/logo-jmri.gif" width="160" height="135" alt="JMRI Logo"> </a>
	<!-- /Logo -->
	<ul id="mainNav"> <!-- Top tool bar -->
	   <li><a href="/download/"  title="Get the latest software">Download</a></li>
	   <li><a href="/apps/"      title="Learn about JMRI applications">Applications</a></li>
	   <li><a href="/hardware/"  title="What hardware does JMRI support">Hardware</a></li>
	   <li><a href="/doc/Manual/"   title="Trouble-shooting, and FAQs">Manual</a></li>
	   <li><a href="/doc/Technical/" title="Developing and extending JMRI">Developers</a></li>
	   <li><A href="/community/" title="Who is JMRI">Acknowledgements</a></li>
	</ul>

	<div id="searchform"> <!--  Search Form -->
	  <form id="search" method="get" action="http://www.google.com/custom">
	     <label for="q" title="Search JMRI.SourceForge.net">search JMRI: </label>
	     <input type="hidden" name="cof" value="LW:200;LH:95;L:http://JMRI.sourceforge.net/images/logo.gif;GIMP:#cc0000;T:black;ALC:#0000ff;GFNT:grey;LC:#990000;BGC:white;AH:center;VLC:purple;GL:0;GALT:#666633;AWFID:9262c37cefe23a86;">
	    <input type="hidden" name="domains" value="JMRI.sourceforge.net">
	    <input type="hidden" name="sitesearch" value="JMRI.sourceforge.net">
	    <input type="text" id="q" name="q" accesskey="s" size="30">
	    <input type="submit" id="submit" value="go">
	  </form>
       </div> <!--  End #searchform -->
    </div> <!-- closes #header-->
<!-- /Header -->

    <hr class="hide">

    <div class="nomenu" id="mBody">
	<div id="mainContent">
	    <!-- ------------- -->
	    <!-- Page Contents --> <!-- Required -->
	    <!-- ------------- -->

<h1>LocoNet addressing</h1>

LocoNet systems address input sensors and output turnouts using numbers.
This page talks about how those numbers are defined in JMRI, and how they relate
to the numbers in other systems.

<h2>Addressing LocoNet turnouts in JMRI</h2>

Inside packets on the LocoNet, output turnouts are addressed with numbers from 0 to 4095.
Throttles, however, address these with numbers from 1 to 4096. To avoid user
confusion, JMRI uses the same numbering as the throttles:  LT1 to LT4096.
<P>
Note that when the LocoNet monitor panel shows the contents of the LocoNet packets
in text, it uses the same addressing, hence
1 to 4096.  This is then 
different from the raw bytes that are displayed, but
at least it's consistent with what users expect to see.
We agree that's confusing, but there has to be some confusion somewhere, given
the way this was set up.

<h2>Addressing LocoNet sensors in JMRI</h2>

Inside packets on the LocoNet, sensors are addressed with numbers from 0 to 4095.
Digitrax documentation refers to these as 1 to 4096, however.  Just like
turnouts, we use the documentation numbering to define the sensor names: LS1 to LS4096.
<P>
The simplest way to find the 
right number for a given block is to open a "LocoNet monitor" window, and drop a 
locomotive onto the block you're interested in.  You'll see the 
LocoNet message, complete with number, in the window that looks 
something like this:
<PRE>
   General sensor input report: contact 161 (DS54 switch 81 Aux input) (BDL16 11,1) is Hi 
</PRE>
The contact number, 161 in this case, is the address of the sensor.
Prefix that with LS that to get the sensor name, e.g. LS161 in this case.
<P>
If you want to calculate the address of a BDL168 input, you can use
<CODE>
<PRE>
   number = 16 * (board number) + (channel number) - 16
</PRE></CODE>
where "channel number" runs from 1 to 16.  For example, the first circuit
(number 1) on board 11 has number:
<CODE>
<PRE>
   number = 16 * (11) + (1) - 16 = 161
</PRE></CODE>
as we saw in the example above.

<h2>Addressing Transponding in JMRI</h2>

Digitrax transponding is handled via the Reporter mechanism
in JMRI.  Reporters gather information from the layout and make it
available when it changes.
<P>
The transponding zones are numbered sequentially from 1, so that
1 through 4 are on the 1st BDL16, etc.

<!-- Footer -->
    <hr class="hide">
    <div id="footer">
	<ul id="bn">
	<li><a href="/sitemap/">Site Map</a></li>
	<li><a href="/contact/">Contact Us</a></li>
	</ul>

	<p>Thanks and congratulations to
	   <A href="/community/" title="Who is JMRI">
	   	all who contributed</A>! </p>

	<p>Copyright &copy; 1997 - 2004 JMRI Community. 
	<P>JMRI, DecoderPro, PanelPro, DispatcherPro and associated logos are our trademarks.
	<P><A href="/Copyright.html">Additional information on copyright, trademarks and licenses is linked here.</a></p>
    
       <BR/>Site hosted by: <BR/>
        <A href="http://sourceforge.net"> 
        <IMG src="http://sourceforge.net/sflogo.php?group_id=26788&amp;type=1" width="88" height="31" border="0" alt="SourceForge Logo"> </A> 


    </div>
<!-- /Footer -->

	  </div><!-- closes #mainContent-->
	</div> <!-- closes #mBody-->
</body>
</html>

