<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html lang="en">
<head>
 <TITLE>
 JMRI: EasyDCC Terminal Server Connection
 
 </TITLE>
    <META http-equiv=Content-Type content="text/html; charset=iso-8859-1">
    <META content="David D Zuhn" name=Author>
    <META content="John Plocher" name=Author>
    <META name="keywords" content="EasyDCC Lantronics terminal server java model railroad JMRI install">

<!-- Style -->
   <!-- $Id: TerminalServer.html,v 1.4 2004-07-19 01:10:28 jacobsen Exp $ -->
  <META http-equiv=Content-Type content="text/html; charset=iso-8859-1">
  <link rel="stylesheet" type="text/css" href="/css/default.css" media="screen">
  <link rel="stylesheet" type="text/css" href="/css/print.css" media="print">
  <link rel="icon" href="/images/jmri.ico" type="image/png">
  <link rel="home" title="Home" href="/">
<!-- /Style -->
</head>

<body>
<div id="container">
  <p class="skipLink"><a href="#mainContent" accesskey="2">Skip to main content</a></p>
<!-- Header -->
    <div id="header">
	<!-- Logo -->
	<a href="/" title="Return to home page" accesskey="1">
	    <img src="/images/logo-jmri.gif" width="160" height="135" alt="JMRI Logo"> </a>
	<!-- /Logo -->
	<ul id="mainNav"> <!-- Top tool bar -->
	   <li><a href="/download/"  title="Get the latest software">Download</a></li>
	   <li><a href="/apps/"      title="Learn about JMRI applications">Applications</a></li>
	   <li><a href="/hardware/"  title="What hardware does JMRI support">Hardware</a></li>
	   <li><a href="/doc/Manual/"   title="Trouble-shooting, and FAQs">Manual</a></li>
	   <li><a href="/doc/Technical/" title="Developing and extending JMRI">Developers</a></li>
	   <li><A href="/community/" title="Who is JMRI">Acknowledgements</a></li>
	</ul>

	<div id="searchform"> <!--  Search Form -->
	  <form id="search" method="get" action="http://www.google.com/custom">
	     <label for="q" title="Search JMRI.SourceForge.net">search JMRI: </label>
	     <input type="hidden" name="cof" value="LW:200;LH:95;L:http://JMRI.sourceforge.net/images/logo.gif;GIMP:#cc0000;T:black;ALC:#0000ff;GFNT:grey;LC:#990000;BGC:white;AH:center;VLC:purple;GL:0;GALT:#666633;AWFID:9262c37cefe23a86;">
	    <input type="hidden" name="domains" value="JMRI.sourceforge.net">
	    <input type="hidden" name="sitesearch" value="JMRI.sourceforge.net">
	    <input type="text" id="q" name="q" accesskey="s" size="30">
	    <input type="submit" id="submit" value="go">
	  </form>
       </div> <!--  End #searchform -->
    </div> <!-- closes #header-->
<!-- /Header -->





  <hr class="hide">

  <div class="nomenu" id="mBody">
    <div id="mainContent">
      <H2> 
      JMRI Install Guide:EasyDCC Terminal Server Connection
      </H2>

      <p>David Zuhn writes...</p>

      <p>I am currently running DecoderPro on my home Linux boxes, using a
      <a HREF="http://www.lantronix.com/">Lantronix</a>
      terminal server, model
      <a HREF="http://www.lantronix.com/products/ts/ets4p_8p_16p/index.html">ETS-4P</a>.
      </p>

      <p>What's that?  It's a small box, with a handful of serial ports and an
    Ethernet connection.  There's sufficient software built into the box to
    allow any computer to make a network connection to the terminal server,
    selecting which serial port the data stream should connect to.  This means
    on the main computer, there's no serial port setup to mess with (it's just a
    simple TCP network connection).  All of the serial setup is done on a box
    that's very specifically designed to make this easy.</p>

    <p>I'm doing this because 
    <ul>
      <li>my model railroad controls aren't anyplace particularly close to my
	computers,
      <li>the only computer that I might be willing to move only has a single
	serial port, and I expect to need at least two in the near future. but
      <li>I don't want a computer in the middle of my layout anyway, and
      <li>I don't like overly long RS-232 serial cables, and lastly,
      <li>I didn't want to build/buy yet another computer (I have enough as it
	is, and I can live without additional fan noise and the need to shut it
	down cleanly, etc.)
    </ul>
    </p>

    <h2>Making the Cable</h2>
    
    <p>The first part I had to worry about was making a cable.  The Lantronix
    box uses 8-pin modular plugs, and the EasyDCC command station uses a 6-pin
    modular plug.  I had already made the necessary adapter from the 6 box
    modular to a DB-9 Female.  I could have used a DB-9 made to Lantronix cable,
    if I had one handy.  Alas, I didn't.  And that's sort of a frankenstein's
    monster setup anyway.</p>
    <p>The pinouts for EasyDCC are well documented (page 152 of my manual).  The
      pinouts for the Lantronix are slightly harder to find, but available on the
      Lantronix web site (search product support for "pinouts", their search
      engine doesn't handle links well). </p>

    <h3>Lantronix</h3>

    <p>When looking at the 8-pin socket with the notch for the locking
      tab facing down the pins are numbered 1-8 left to right:

      <blockquote></blockquote>

    <div ALIGN="CENTER">
    <table BORDER=1>

      <tr><td COLSPAN=8><tt>
&nbsp;12345678  <br>
[||||||||]<br>
[&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;]<br>
[__&nbsp;&nbsp;&nbsp;&nbsp;__]<br>
&nbsp;&nbsp;&nbsp;|__|</tt></td></tr>
      <tr><td>1</td><td>2</td><td>3</td><td>4</td><td>5</td><td>6</td><td>7</td><td>8</td></tr>
      <tr><td>RTS</td><td>DTR</td><td>Tx+</td><td>Tx-</td><td>Rx-</td><td>Rx+</td><td>DSR</td><td>CTS</td></tr>

	
    </table>
    </div>

    <h3>EasyDCC</h3>

    <p>When looking at the 6-pin socket with the notch for the locking
      tab facing down the pins are numbered 1-6 left to right:

      <blockquote></blockquote>

    <div ALIGN="CENTER">
    <table BORDER=1>

      <tr><td COLSPAN=8><tt>
&nbsp;123456<br>
[||||||]<br>
[&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;]<br>
[_&nbsp;&nbsp;&nbsp;&nbsp;_]<br>
&nbsp;&nbsp;|__|</tt></td></tr>
      <tr><td>1</td><td>2</td><td>3</td><td>4</td><td>5</td><td>6</td></tr>
      <tr><td>Tx</td><td>GND</td><td></td><td></td><td>GND</td><td>Rx</td></tr>

    </table>
    </div>


    <p>So it's a simple matter.  Tx on one end to Rx on the other.  Vice versa.
      Connect the grounds.  Pull out the satin cable, a 6 pin connector, an 8
      pin connector, expose the wires, re-arrange, and crimp.</p>

    <p>This could have two 6 pin ends, but I chose one 6 and one 8 so that I 
      couldn't get the cable installed wrong (the EasyDCC command station won't
      take an 8 pin plug).</p>

    <p>On the 6 pin end, I just wired straight across.  It was the easiest way
      and there's no reason not to.  On the 8 pin end, I removed the middle two
      wires (they're of no use for this cable).  Then I reversed the order
      (which handles the Rx-to-Tx connection) and laid them into pins 3-6.
      Crimp. Done. </p>

    <h2>Lantronix Configuration</h2>

    <p>Now it's an issue of setting up the Lantronix.  I won't go into all the
    details.  If you've got one, read the manual.  If you don't, details won't
    matter to you.</p>
    
    <h3>Network</h3>

    <p>The machine is configured to receive an address upon boot via DHCP.  I
      already have DHCP configured on my home network, so this wasn't much extra
      work.  It received a fixed address, so I know what the address will be.<p>
      
    <h3>Serial Ports</h3>

    <p>This is the meat of the configuration.  Set it up for 9600 baud, 8 data
      bits, 1 stop bit, no parity (<tt>9600,8,1,none</tt>) and no flow control.
      Configure it for remote access (so that connecting to the right network port
      will activate the connection to the serial port).  Then turn off telnet
      padding.  This gives you the complete data stream without
      modification.</p>

    <p>On the Lantronix, make sure these are all <tt>DEFINE</tt>d, not
    <tt>SET</tt>, to ensure persistence across power cycles.</p>

    <p>My configuration summary is shown below:

       <blockquote><pre>

Local> show port 4
 
Port 4 : Username:                     Physical Port 4 (Idle)
                                                              
   Char Size/Stop Bits:         8/1    Input Speed:                 9600
   Flow Ctrl:                  None    Output Speed:                9600
   Parity:                     None    Modem Control:               None
                                                                         
   Access:                   Remote    Local Switch:                None
   Backward:                   None    Port Name:                 Port_4
   Break Ctrl:                 None    Session Limit:                  4
   Forward:                    None    Terminal Type:             Soft()
 
   Preferred Services:        (Lat)
                           (Telnet)
                                     
   Authorized Groups : 0
   (Current)  Groups : 0
 
   Characteristics:  Broadcast  Loss Notify  Verify
</pre></blockquote></p>

    <h2>JMRI configuration</h2>

    <p>Buried away in the JMRI 1.3.5 configuration is a <tt>Layout
    Connection</tt> choice called "<tt>EasyDCC via network</tt>".  Select this,
    and then enter the hostname (or address) of the terminal server, then the
    network port number (on Lantronix boxes, this is 2000+the physical port
    number on the back of the box).</p>

    <p>This is all it took to get things working.  Please note that this
    configuration does NOT use the computer's serial port.  On Linux boxes, this
    means you don't need to use or configure <tt>rxtx</tt> and
    <tt>javax.comm</tt>.</p>

    <h2>The Last Word</h2>

    <p>I've had this working now for just a short time.  It's nice, since I
    can run DecoderPro from any computer at home, not just one with a serial
    port connected to the command station.</p>

    <p>Kudos to Bob Jacobsen.  I asked for a pointer as to where to start, in
    order to implement the JMRI changes myself.  Just a couple of days later, he
    had done all the coding necessary.  That's just wonderful support.  I do
    love this open source community thing.</p>

      <hr class="hide">
<!-- Footer -->
    <hr class="hide">
    <div id="footer">
	<ul id="bn">
	<li><a href="/sitemap/">Site Map</a></li>
	<li><a href="/contact/">Contact Us</a></li>
	</ul>

	<p>Thanks and congratulations to
	   <A href="/community/" title="Who is JMRI">
	   	all who contributed</A>! </p>

	<p>Copyright &copy; 2003,2004 JMRI Community</p>
        <BR/>Site hosted by: <BR/>
        <A href="http://sourceforge.net"> 
        <IMG src="http://sourceforge.net/sflogo.php?group_id=26788&amp;type=1" width="88" height="31" border="0" alt="SourceForge Logo"> </A> 


    </div>
<!-- /Footer -->

   </div><!-- closes #mainContent-->
  </div> <!-- closes #mBody-->
</div> <!-- closes #container -->
</body>
</html>

