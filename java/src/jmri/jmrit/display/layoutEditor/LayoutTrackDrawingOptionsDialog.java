/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package jmri.jmrit.display.layoutEditor;

import java.awt.Color;
import java.awt.event.ActionEvent;
import java.util.ArrayList;
import java.util.List;
import javax.swing.BorderFactory;
import javax.swing.JButton;
import javax.swing.JDialog;
import javax.swing.JSpinner;
import javax.swing.event.ChangeEvent;
import jmri.util.swing.JmriColorChooser;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;

/*******************************************************************************
 * Handle changing layout editor drawing options.
 * 
 * since 4.15.6 blockDefaultColor, blockOccupiedColor and blockAlternativeColor added here.
 * Color settings blockDefaultColor, blockOccupiedColor and blockAlternativeColor respects the original solution. 
 * It would be useful to drop the original defaultTrackColor, defaultOccupiedTrackColor 
 * and defaultAlternativeTrackColor variables In {@link LayoutEditor} and use only those of 
 * {@link LayoutTrackDrawingOptions}. 
 * 
 * @author George Warner Copyright (c) 2017-2018
 */
public class LayoutTrackDrawingOptionsDialog extends JDialog {

    private final LayoutEditor layoutEditor;
    private transient final LayoutTrackDrawingOptions leLTDOptions;
    private transient LayoutTrackDrawingOptions ltdOptions = null;

    private String classicPresetName = Bundle.getMessage("ClassicPresetName");
    private String draftingPresetName = Bundle.getMessage("DraftingPresetName");
    private String realisticPresetName = Bundle.getMessage("RealisticPresetName");
    private String realisticOhPresetName = Bundle.getMessage("RealisticOhPresetName");
    private String british70sPresetName = Bundle.getMessage("British70sPresetName");
    private String csdazd71PresetName = Bundle.getMessage("CsdAzd71PresetName");
    private String customPresetName = Bundle.getMessage("CustomPresetName");

    private transient final List<LayoutTrackDrawingOptions> ltdoList = new ArrayList<>();

    /**
     * Creates new form LayoutTrackDrawingOptionsDialog
     */
    public LayoutTrackDrawingOptionsDialog(LayoutEditor layoutEditor, boolean modal,
            LayoutTrackDrawingOptions ltdOptions) {
        super(layoutEditor, modal);

        this.layoutEditor = layoutEditor;
        this.leLTDOptions = ltdOptions;
        this.ltdOptions = new LayoutTrackDrawingOptions(ltdOptions);

        initComponents();
        this.setTitle(Bundle.getMessage("SetTrackDrawingOptions"));
        setLocationRelativeTo(layoutEditor);
        definePresets();
        pack();
    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {
        java.awt.GridBagConstraints gridBagConstraints;

        optionsPanel = new javax.swing.JPanel();
        optionLabel = new javax.swing.JLabel();

        javax.swing.JLabel blockDefaultColorLabel = new javax.swing.JLabel();
        blockDefaultColorButton = new javax.swing.JButton();
        javax.swing.JLabel blockOccupiedColorLabel = new javax.swing.JLabel();
        blockOccupiedColorButton = new javax.swing.JButton();
        javax.swing.JLabel blockAlternativeColorLabel = new javax.swing.JLabel();
        blockAlternativeColorButton = new javax.swing.JButton();
        
        mainlineLabel = new javax.swing.JLabel();
        railCountLabel = new javax.swing.JLabel();
        mainRailCountSpinner = new javax.swing.JSpinner();
        sideRailCountSpinner = new javax.swing.JSpinner();
        railWidthLabel = new javax.swing.JLabel();
        mainRailWidthSpinner = new javax.swing.JSpinner();
        sideRailWidthSpinner = new javax.swing.JSpinner();
        railGapLabel = new javax.swing.JLabel();
        sideRailGapSpinner = new javax.swing.JSpinner();
        mainRailGapSpinner = new javax.swing.JSpinner();
        javax.swing.JLabel railColorLabel = new javax.swing.JLabel();
        mainRailColorButton = new javax.swing.JButton();
        sideRailColorButton = new javax.swing.JButton();
        blockLineWidthLabel = new javax.swing.JLabel();
        mainBlockLineWidthSpinner = new javax.swing.JSpinner();
        sideBlockLineWidthSpinner = new javax.swing.JSpinner();
        ballastWidthLabel = new javax.swing.JLabel();
        mainBallastWidthSpinner = new javax.swing.JSpinner();
        sideBallastWidthSpinner = new javax.swing.JSpinner();
        javax.swing.JLabel ballastColorLabel = new javax.swing.JLabel();
        mainBallastColorButton = new javax.swing.JButton();
        sideBallastColorButton = new javax.swing.JButton();
        tieLengthLabel = new javax.swing.JLabel();
        mainTieLengthSpinner = new javax.swing.JSpinner();
        sideTieLengthSpinner = new javax.swing.JSpinner();
        tieWidthLabel = new javax.swing.JLabel();
        mainTieWidthSpinner = new javax.swing.JSpinner();
        sideTieWidthSpinner = new javax.swing.JSpinner();
        tieGapLabel = new javax.swing.JLabel();
        mainTieGapSpinner = new javax.swing.JSpinner();
        sideTieGapSpinner = new javax.swing.JSpinner();
        javax.swing.JLabel tieColorLabel = new javax.swing.JLabel();
        mainTieColorButton = new javax.swing.JButton();
        sideTieColorButton = new javax.swing.JButton();
        sidelineLabel = new javax.swing.JLabel();
        blockLineDashPercentageX10Label = new javax.swing.JLabel();
        mainBlockLineDashPercentageX10Spinner = new javax.swing.JSpinner();
        sideBlockLineDashPercentageX10Spinner = new javax.swing.JSpinner();
        jPanelButtons = new javax.swing.JPanel();
        presetsLabel = new javax.swing.JLabel();
        presetsComboBox = new javax.swing.JComboBox<>();
        applyButton = new javax.swing.JButton();
        cancelButton = new javax.swing.JButton();
        okButton = new javax.swing.JButton();

        setDefaultCloseOperation(javax.swing.WindowConstants.DISPOSE_ON_CLOSE);
        setTitle("SetTrackDrawingOptions");
        setSize(new java.awt.Dimension(512, 329));

        optionsPanel.setBorder(javax.swing.BorderFactory.createTitledBorder(ltdOptions.getName()));
        java.awt.GridBagLayout optionsPanelLayout = new java.awt.GridBagLayout();
        optionsPanelLayout.columnWidths = new int[] {0, 5, 0, 5, 0};
        optionsPanelLayout.rowHeights = new int[] {0, 5, 0, 5, 0, 5, 0, 5, 0, 5, 0, 5, 0, 5, 0, 5, 0, 5, 0, 5, 0, 5, 0, 5, 0, 5, 0, 5, 0, 5, 0, 5, 0};
        optionsPanel.setLayout(optionsPanelLayout);

        // 0 -------------------------------------------------------------------
        optionLabel.setFont(optionLabel.getFont().deriveFont(optionLabel.getFont().getStyle() | java.awt.Font.BOLD));
        optionLabel.setText(Bundle.getMessage("OptionLabelText"));
        optionLabel.setToolTipText(Bundle.getMessage("OptionToolTip"));
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 0;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.BASELINE_LEADING;
        gridBagConstraints.weightx = 100.0;
        optionsPanel.add(optionLabel, gridBagConstraints);

        mainlineLabel.setFont(mainlineLabel.getFont().deriveFont(mainlineLabel.getFont().getStyle() | java.awt.Font.BOLD));
        mainlineLabel.setText(Bundle.getMessage("MainlineLabelText"));
        mainlineLabel.setToolTipText(Bundle.getMessage("MainlineColumnToolTip"));
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 2;
        gridBagConstraints.gridy = 0;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.weightx = 30.0;
        optionsPanel.add(mainlineLabel, gridBagConstraints);

        sidelineLabel.setFont(sidelineLabel.getFont().deriveFont(sidelineLabel.getFont().getStyle() | java.awt.Font.BOLD));
        sidelineLabel.setText(Bundle.getMessage("SidelineLabelText"));
        sidelineLabel.setToolTipText(Bundle.getMessage("SidelineColumnToolTip"));
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 4;
        gridBagConstraints.gridy = 0;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.weightx = 30.0;
        optionsPanel.add(sidelineLabel, gridBagConstraints);
        
        // 2 -------------------------------------------------------------------
        railCountLabel.setText(Bundle.getMessage("RailCountLabelText"));
        railCountLabel.setToolTipText(Bundle.getMessage("RailCountToolTip"));
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 2;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.BASELINE_LEADING;
        optionsPanel.add(railCountLabel, gridBagConstraints);

        mainRailCountSpinner.setModel(new javax.swing.SpinnerNumberModel(1, 0, 3, 1));
        mainRailCountSpinner.setToolTipText(Bundle.getMessage("MainRailCountToolTip"));
        mainRailCountSpinner.setName(""); // NOI18N
        mainRailCountSpinner.setValue(ltdOptions.getMainRailCount());
        mainRailCountSpinner.addChangeListener(new javax.swing.event.ChangeListener() {
            @Override
            public void stateChanged(javax.swing.event.ChangeEvent evt) {
                mainRailCountSpinnerStateChanged(evt);
            }
        });
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 2;
        gridBagConstraints.gridy = 2;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.BASELINE;
        optionsPanel.add(mainRailCountSpinner, gridBagConstraints);

        sideRailCountSpinner.setModel(new javax.swing.SpinnerNumberModel(1, 0, 3, 1));
        sideRailCountSpinner.setToolTipText(Bundle.getMessage("SideRailCountToolTip"));
        sideRailCountSpinner.setName(""); // NOI18N
        sideRailCountSpinner.setValue(ltdOptions.getSideRailCount());
        sideRailCountSpinner.addChangeListener(new javax.swing.event.ChangeListener() {
            @Override
            public void stateChanged(javax.swing.event.ChangeEvent evt) {
                sideRailCountSpinnerStateChanged(evt);
            }
        });
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 4;
        gridBagConstraints.gridy = 2;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.BASELINE;
        optionsPanel.add(sideRailCountSpinner, gridBagConstraints);

        // 4 -------------------------------------------------------------------
        railWidthLabel.setText(Bundle.getMessage("RailWidthLabelText"));
        railWidthLabel.setToolTipText(Bundle.getMessage("RailWidthToolTip"));
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 4;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.BASELINE_LEADING;
        optionsPanel.add(railWidthLabel, gridBagConstraints);

        mainRailWidthSpinner.setModel(new javax.swing.SpinnerNumberModel(2, 0, null, 1));
        mainRailWidthSpinner.setToolTipText(Bundle.getMessage("MainRailWidthToolTip"));
        mainRailWidthSpinner.setEnabled(ltdOptions.getMainRailCount() > 0);
        mainRailWidthSpinner.setName(""); // NOI18N
        mainRailWidthSpinner.setValue(ltdOptions.getMainRailWidth());
        mainRailWidthSpinner.addChangeListener(new javax.swing.event.ChangeListener() {
            @Override
            public void stateChanged(javax.swing.event.ChangeEvent evt) {
                mainRailWidthSpinnerStateChanged(evt);
            }
        });
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 2;
        gridBagConstraints.gridy = 4;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.BASELINE;
        optionsPanel.add(mainRailWidthSpinner, gridBagConstraints);

        sideRailWidthSpinner.setModel(new javax.swing.SpinnerNumberModel(0, 0, null, 1));
        sideRailWidthSpinner.setToolTipText(Bundle.getMessage("SideRailWidthToolTip"));
        sideRailWidthSpinner.setEnabled(ltdOptions.getSideRailCount() > 0);
        sideRailWidthSpinner.setName(""); // NOI18N
        sideRailWidthSpinner.setValue(ltdOptions.getSideRailWidth());
        sideRailWidthSpinner.addChangeListener(new javax.swing.event.ChangeListener() {
            @Override
            public void stateChanged(javax.swing.event.ChangeEvent evt) {
                sideRailWidthSpinnerStateChanged(evt);
            }
        });
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 4;
        gridBagConstraints.gridy = 4;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.BASELINE;
        optionsPanel.add(sideRailWidthSpinner, gridBagConstraints);

        // 6 -------------------------------------------------------------------
        railGapLabel.setText(Bundle.getMessage("RailGapLabelText"));
        railGapLabel.setToolTipText(Bundle.getMessage("RailGapToolTip"));
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 6;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.BASELINE_LEADING;
        optionsPanel.add(railGapLabel, gridBagConstraints);

        sideRailGapSpinner.setModel(new javax.swing.SpinnerNumberModel(1, 1, null, 1));
        sideRailGapSpinner.setToolTipText(Bundle.getMessage("SideRailGapToolTip"));
        sideRailGapSpinner.setEnabled(ltdOptions.getSideRailCount() > 1);
        sideRailGapSpinner.setName(""); // NOI18N
        sideRailGapSpinner.setValue(ltdOptions.getSideRailGap());
        sideRailGapSpinner.addChangeListener(new javax.swing.event.ChangeListener() {
            @Override
            public void stateChanged(javax.swing.event.ChangeEvent evt) {
                sideRailGapSpinnerStateChanged(evt);
            }
        });
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 4;
        gridBagConstraints.gridy = 6;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.BASELINE;
        optionsPanel.add(sideRailGapSpinner, gridBagConstraints);

        mainRailGapSpinner.setModel(new javax.swing.SpinnerNumberModel(1, 1, null, 1));
        mainRailGapSpinner.setToolTipText(Bundle.getMessage("MainRailGapToolTip"));
        mainRailGapSpinner.setEnabled(ltdOptions.getMainRailCount() > 1);
        mainRailGapSpinner.setName(""); // NOI18N
        mainRailGapSpinner.setValue(ltdOptions.getMainRailGap());
        mainRailGapSpinner.addChangeListener(new javax.swing.event.ChangeListener() {
            @Override
            public void stateChanged(javax.swing.event.ChangeEvent evt) {
                mainRailGapSpinnerStateChanged(evt);
            }
        });
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 2;
        gridBagConstraints.gridy = 6;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.BASELINE;
        optionsPanel.add(mainRailGapSpinner, gridBagConstraints);

        // 8 -------------------------------------------------------------------
        railColorLabel.setText(Bundle.getMessage("RailColorLabelText"));
        railColorLabel.setToolTipText(Bundle.getMessage("RailColorToolTip"));
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 8;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.BASELINE_LEADING;
        optionsPanel.add(railColorLabel, gridBagConstraints);

        mainRailColorButton.setBackground(ltdOptions.getMainRailColor());
        mainRailColorButton.setToolTipText(Bundle.getMessage("MainRailColorToolTip"));
        mainRailColorButton.setBorder(javax.swing.BorderFactory.createBevelBorder(javax.swing.border.BevelBorder.LOWERED));
        mainRailColorButton.setEnabled(ltdOptions.getMainRailCount() > 0);
        mainRailColorButton.setOpaque(true);
        mainRailColorButton.addActionListener(new java.awt.event.ActionListener() {
            @Override
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                mainRailColorButtonActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout mainRailColorButtonLayout = new javax.swing.GroupLayout(mainRailColorButton);
        mainRailColorButton.setLayout(mainRailColorButtonLayout);
        mainRailColorButtonLayout.setHorizontalGroup(
            mainRailColorButtonLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 0, Short.MAX_VALUE)
        );
        mainRailColorButtonLayout.setVerticalGroup(
            mainRailColorButtonLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 0, Short.MAX_VALUE)
        );

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 2;
        gridBagConstraints.gridy = 8;
        gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.BASELINE;
        optionsPanel.add(mainRailColorButton, gridBagConstraints);

        sideRailColorButton.setBackground(ltdOptions.getSideRailColor());
        sideRailColorButton.setToolTipText(Bundle.getMessage("SideRailColorToolTip"));
        sideRailColorButton.setBorder(javax.swing.BorderFactory.createBevelBorder(javax.swing.border.BevelBorder.LOWERED));
        sideRailColorButton.setEnabled(ltdOptions.getSideRailCount() > 0);
        sideRailColorButton.setOpaque(true);
        sideRailColorButton.addActionListener(new java.awt.event.ActionListener() {
            @Override
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                sideRailColorButtonActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout sideRailColorButtonLayout = new javax.swing.GroupLayout(sideRailColorButton);
        sideRailColorButton.setLayout(sideRailColorButtonLayout);
        sideRailColorButtonLayout.setHorizontalGroup(
            sideRailColorButtonLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 0, Short.MAX_VALUE)
        );
        sideRailColorButtonLayout.setVerticalGroup(
            sideRailColorButtonLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 0, Short.MAX_VALUE)
        );

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 4;
        gridBagConstraints.gridy = 8;
        gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.BASELINE;
        optionsPanel.add(sideRailColorButton, gridBagConstraints);

        // 10 ------------------------------------------------------------------
        blockLineWidthLabel.setText(Bundle.getMessage("BlockLineWidthLabelText"));
        blockLineWidthLabel.setToolTipText(Bundle.getMessage("BlockLineWidthToolTip"));
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 10;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.BASELINE_LEADING;
        optionsPanel.add(blockLineWidthLabel, gridBagConstraints);

        mainBlockLineWidthSpinner.setModel(new javax.swing.SpinnerNumberModel(1, 1, null, 1));
        mainBlockLineWidthSpinner.setToolTipText(Bundle.getMessage("MainBlockLineWidthToolTip"));
        mainBlockLineWidthSpinner.setName(""); // NOI18N
        mainBlockLineWidthSpinner.setValue(ltdOptions.getMainBlockLineWidth());
        mainBlockLineWidthSpinner.addChangeListener(new javax.swing.event.ChangeListener() {
            @Override
            public void stateChanged(javax.swing.event.ChangeEvent evt) {
                mainBlockLineWidthSpinnerStateChanged(evt);
            }
        });
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 2;
        gridBagConstraints.gridy = 10;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.BASELINE;
        optionsPanel.add(mainBlockLineWidthSpinner, gridBagConstraints);

        sideBlockLineWidthSpinner.setModel(new javax.swing.SpinnerNumberModel(1, 1, null, 1));
        sideBlockLineWidthSpinner.setToolTipText(Bundle.getMessage("SideBlockLineWidthToolTip"));
        sideBlockLineWidthSpinner.setName(""); // NOI18N
        sideBlockLineWidthSpinner.setValue(ltdOptions.getSideBlockLineWidth());
        sideBlockLineWidthSpinner.addChangeListener(new javax.swing.event.ChangeListener() {
            @Override
            public void stateChanged(javax.swing.event.ChangeEvent evt) {
                sideBlockLineWidthSpinnerStateChanged(evt);
            }
        });
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 4;
        gridBagConstraints.gridy = 10;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.BASELINE;
        optionsPanel.add(sideBlockLineWidthSpinner, gridBagConstraints);

        // 12 ------------------------------------------------------------------
        blockLineDashPercentageX10Label.setText(Bundle.getMessage("BlockLineDashPercentageX10LabelText"));
        blockLineDashPercentageX10Label.setToolTipText(Bundle.getMessage("BlockLineDashPercentageX10ToolTip"));
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 12;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.BASELINE_LEADING;
        optionsPanel.add(blockLineDashPercentageX10Label, gridBagConstraints);

        mainBlockLineDashPercentageX10Spinner.setModel(new javax.swing.SpinnerNumberModel(1, 0, 9, 1));
        mainBlockLineDashPercentageX10Spinner.setToolTipText(Bundle.getMessage("MainBlockLineWidthToolTip"));
        mainBlockLineDashPercentageX10Spinner.setEnabled(ltdOptions.getMainBlockLineWidth() > 0);
        mainBlockLineDashPercentageX10Spinner.setName(""); // NOI18N
        mainBlockLineDashPercentageX10Spinner.setValue(ltdOptions.getMainBlockLineDashPercentageX10());
        mainBlockLineDashPercentageX10Spinner.addChangeListener(new javax.swing.event.ChangeListener() {
            @Override
            public void stateChanged(javax.swing.event.ChangeEvent evt) {
                mainBlockLineDashPercentageX10SpinnerStateChanged(evt);
            }
        });
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 2;
        gridBagConstraints.gridy = 12;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.BASELINE;
        optionsPanel.add(mainBlockLineDashPercentageX10Spinner, gridBagConstraints);

        sideBlockLineDashPercentageX10Spinner.setModel(new javax.swing.SpinnerNumberModel(1, 0, 9, 1));
        sideBlockLineDashPercentageX10Spinner.setToolTipText(Bundle.getMessage("SideBlockLineDashPercentageX10ToolTip"));
        sideBlockLineDashPercentageX10Spinner.setEnabled(ltdOptions.getSideBlockLineWidth() > 0);
        sideBlockLineDashPercentageX10Spinner.setName(""); // NOI18N
        sideBlockLineDashPercentageX10Spinner.setValue(ltdOptions.getSideBlockLineDashPercentageX10());
        sideBlockLineDashPercentageX10Spinner.addChangeListener(new javax.swing.event.ChangeListener() {
            @Override
            public void stateChanged(javax.swing.event.ChangeEvent evt) {
                sideBlockLineDashPercentageX10SpinnerStateChanged(evt);
            }
        });
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 4;
        gridBagConstraints.gridy = 12;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.BASELINE;
        optionsPanel.add(sideBlockLineDashPercentageX10Spinner, gridBagConstraints);

        // 14 ------------------------------------------------------------------
        blockDefaultColorLabel.setText(Bundle.getMessage("BlockDefaultColorLabelText"));
        blockDefaultColorLabel.setToolTipText(Bundle.getMessage("BlockDefaultColorToolTip"));
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 14;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.BASELINE_LEADING;
        optionsPanel.add(blockDefaultColorLabel, gridBagConstraints);

        blockDefaultColorButton.setBackground(layoutEditor.getDefaultTrackColorColor());
        blockDefaultColorButton.setToolTipText(Bundle.getMessage("BlockDefaultColorToolTip"));
        blockDefaultColorButton.setBorder(javax.swing.BorderFactory.createBevelBorder(javax.swing.border.BevelBorder.LOWERED));
        blockDefaultColorButton.setEnabled(true);
        blockDefaultColorButton.setOpaque(true);
        blockDefaultColorButton.addActionListener(new java.awt.event.ActionListener() {
            @Override
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                blockDefaultColorButtonActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout blockDefaultColorButtonLayout = new javax.swing.GroupLayout(blockDefaultColorButton);
        blockDefaultColorButton.setLayout(blockDefaultColorButtonLayout);
        blockDefaultColorButtonLayout.setHorizontalGroup(
            blockDefaultColorButtonLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 0, Short.MAX_VALUE)
        );
        blockDefaultColorButtonLayout.setVerticalGroup(
            blockDefaultColorButtonLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 0, Short.MAX_VALUE)
        );

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 2;
        gridBagConstraints.gridy = 14;
        gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.BASELINE;
        optionsPanel.add(blockDefaultColorButton, gridBagConstraints);

        // 16 ------------------------------------------------------------------
        blockOccupiedColorLabel.setText(Bundle.getMessage("BlockOccupiedColorLabelText"));
        blockOccupiedColorLabel.setToolTipText(Bundle.getMessage("BlockOccupiedColorToolTip"));
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 16;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.BASELINE_LEADING;
        optionsPanel.add(blockOccupiedColorLabel, gridBagConstraints);

        blockOccupiedColorButton.setBackground(layoutEditor.getDefaultOccupiedTrackColorColor());
        blockOccupiedColorButton.setToolTipText(Bundle.getMessage("BlockOccupiedColorToolTip"));
        blockOccupiedColorButton.setBorder(javax.swing.BorderFactory.createBevelBorder(javax.swing.border.BevelBorder.LOWERED));
        blockOccupiedColorButton.setEnabled(true);
        blockOccupiedColorButton.setOpaque(true);
        blockOccupiedColorButton.addActionListener(new java.awt.event.ActionListener() {
            @Override
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                blockOccupiedColorButtonActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout blockOccupiedColorButtonLayout = new javax.swing.GroupLayout(blockOccupiedColorButton);
        blockOccupiedColorButton.setLayout(blockOccupiedColorButtonLayout);
        blockOccupiedColorButtonLayout.setHorizontalGroup(
            blockOccupiedColorButtonLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 0, Short.MAX_VALUE)
        );
        blockOccupiedColorButtonLayout.setVerticalGroup(
            blockOccupiedColorButtonLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 0, Short.MAX_VALUE)
        );

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 2;
        gridBagConstraints.gridy = 16;
        gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.BASELINE;
        optionsPanel.add(blockOccupiedColorButton, gridBagConstraints);

        // 18 ------------------------------------------------------------------
        blockAlternativeColorLabel.setText(Bundle.getMessage("BlockAlternativeColorLabelText"));
        blockAlternativeColorLabel.setToolTipText(Bundle.getMessage("BlockAlternativeColorToolTip"));
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 18;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.BASELINE_LEADING;
        optionsPanel.add(blockAlternativeColorLabel, gridBagConstraints);

        blockAlternativeColorButton.setBackground(layoutEditor.getDefaultAlternativeTrackColorColor());
        blockAlternativeColorButton.setToolTipText(Bundle.getMessage("BlockAlternativeColorToolTip"));
        blockAlternativeColorButton.setBorder(javax.swing.BorderFactory.createBevelBorder(javax.swing.border.BevelBorder.LOWERED));
        blockAlternativeColorButton.setEnabled(true);
        blockAlternativeColorButton.setOpaque(true);
        blockAlternativeColorButton.addActionListener(new java.awt.event.ActionListener() {
            @Override
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                blockAlternativeColorButtonActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout blockAlternativeColorButtonLayout = new javax.swing.GroupLayout(blockAlternativeColorButton);
        blockAlternativeColorButton.setLayout(blockAlternativeColorButtonLayout);
        blockAlternativeColorButtonLayout.setHorizontalGroup(
            blockAlternativeColorButtonLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 0, Short.MAX_VALUE)
        );
        blockAlternativeColorButtonLayout.setVerticalGroup(
            blockAlternativeColorButtonLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 0, Short.MAX_VALUE)
        );

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 2;
        gridBagConstraints.gridy = 18;
        gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.BASELINE;
        optionsPanel.add(blockAlternativeColorButton, gridBagConstraints);

        // 20 ------------------------------------------------------------------
        ballastWidthLabel.setText(Bundle.getMessage("BallastWidthLabelText"));
        ballastWidthLabel.setToolTipText(Bundle.getMessage("BallastWidthToolTip"));
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 20;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.BASELINE_LEADING;
        optionsPanel.add(ballastWidthLabel, gridBagConstraints);

        mainBallastWidthSpinner.setModel(new javax.swing.SpinnerNumberModel(0, 0, null, 1));
        mainBallastWidthSpinner.setToolTipText(Bundle.getMessage("MainBallastWidthToolTip"));
        mainBallastWidthSpinner.setValue(ltdOptions.getMainBallastWidth());
        mainBallastWidthSpinner.addChangeListener(new javax.swing.event.ChangeListener() {
            @Override
            public void stateChanged(javax.swing.event.ChangeEvent evt) {
                mainBallastWidthSpinnerStateChanged(evt);
            }
        });
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 2;
        gridBagConstraints.gridy = 20;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.BASELINE;
        optionsPanel.add(mainBallastWidthSpinner, gridBagConstraints);

        sideBallastWidthSpinner.setModel(new javax.swing.SpinnerNumberModel(0, 0, null, 1));
        sideBallastWidthSpinner.setToolTipText(Bundle.getMessage("SideBallastWidthToolTip"));
        sideBallastWidthSpinner.setValue(ltdOptions.getSideBallastWidth());
        sideBallastWidthSpinner.addChangeListener(new javax.swing.event.ChangeListener() {
            @Override
            public void stateChanged(javax.swing.event.ChangeEvent evt) {
                sideBallastWidthSpinnerStateChanged(evt);
            }
        });
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 4;
        gridBagConstraints.gridy = 20;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.BASELINE;
        optionsPanel.add(sideBallastWidthSpinner, gridBagConstraints);

        // 22 ------------------------------------------------------------------
        ballastColorLabel.setText(Bundle.getMessage("BallastColorLabelText"));
        ballastColorLabel.setToolTipText(Bundle.getMessage("BallastColorToolTip"));
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 22;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.BASELINE_LEADING;
        optionsPanel.add(ballastColorLabel, gridBagConstraints);

        mainBallastColorButton.setBackground(ltdOptions.getMainBallastColor());
        mainBallastColorButton.setToolTipText(Bundle.getMessage("MainBallastColorToolTip"));
        mainBallastColorButton.setBorder(javax.swing.BorderFactory.createBevelBorder(javax.swing.border.BevelBorder.LOWERED));
        mainBallastColorButton.setEnabled(ltdOptions.getMainBallastWidth() > 0);
        mainBallastColorButton.setOpaque(true);
        mainBallastColorButton.addActionListener(new java.awt.event.ActionListener() {
            @Override
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                mainBallastColorButtonActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout mainBallastColorButtonLayout = new javax.swing.GroupLayout(mainBallastColorButton);
        mainBallastColorButton.setLayout(mainBallastColorButtonLayout);
        mainBallastColorButtonLayout.setHorizontalGroup(
            mainBallastColorButtonLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 0, Short.MAX_VALUE)
        );
        mainBallastColorButtonLayout.setVerticalGroup(
            mainBallastColorButtonLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 0, Short.MAX_VALUE)
        );

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 2;
        gridBagConstraints.gridy = 22;
        gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.BASELINE;
        optionsPanel.add(mainBallastColorButton, gridBagConstraints);

        sideBallastColorButton.setBackground(ltdOptions.getSideBallastColor());
        sideBallastColorButton.setToolTipText(Bundle.getMessage("SideBallastColorToolTip"));
        sideBallastColorButton.setBorder(javax.swing.BorderFactory.createBevelBorder(javax.swing.border.BevelBorder.LOWERED));
        sideBallastColorButton.setEnabled(ltdOptions.getSideBallastWidth() > 0);
        sideBallastColorButton.setOpaque(true);
        sideBallastColorButton.addActionListener(new java.awt.event.ActionListener() {
            @Override
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                sideBallastColorButtonActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout sideBallastColorButtonLayout = new javax.swing.GroupLayout(sideBallastColorButton);
        sideBallastColorButton.setLayout(sideBallastColorButtonLayout);
        sideBallastColorButtonLayout.setHorizontalGroup(
            sideBallastColorButtonLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 0, Short.MAX_VALUE)
        );
        sideBallastColorButtonLayout.setVerticalGroup(
            sideBallastColorButtonLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 0, Short.MAX_VALUE)
        );

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 4;
        gridBagConstraints.gridy = 22;
        gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.BASELINE;
        optionsPanel.add(sideBallastColorButton, gridBagConstraints);

        // 24 ------------------------------------------------------------------
        tieLengthLabel.setText(Bundle.getMessage("TieLengthLabelText"));
        tieLengthLabel.setToolTipText(Bundle.getMessage("TieLengthToolTip"));
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 24;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.BASELINE_LEADING;
        optionsPanel.add(tieLengthLabel, gridBagConstraints);

        mainTieLengthSpinner.setModel(new javax.swing.SpinnerNumberModel(0, 0, null, 1));
        mainTieLengthSpinner.setToolTipText(Bundle.getMessage("MainTieLengthToolTip"));
        mainTieLengthSpinner.setValue(ltdOptions.getMainTieLength());
        mainTieLengthSpinner.addChangeListener(new javax.swing.event.ChangeListener() {
            @Override
            public void stateChanged(javax.swing.event.ChangeEvent evt) {
                mainTieLengthSpinnerStateChanged(evt);
            }
        });
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 2;
        gridBagConstraints.gridy = 24;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.BASELINE;
        optionsPanel.add(mainTieLengthSpinner, gridBagConstraints);

        sideTieLengthSpinner.setModel(new javax.swing.SpinnerNumberModel(0, 0, null, 1));
        sideTieLengthSpinner.setToolTipText(Bundle.getMessage("SideTieLengthToolTip"));
        sideTieLengthSpinner.setValue(ltdOptions.getSideTieLength());
        sideTieLengthSpinner.addChangeListener(new javax.swing.event.ChangeListener() {
            @Override
            public void stateChanged(javax.swing.event.ChangeEvent evt) {
                sideTieLengthSpinnerStateChanged(evt);
            }
        });
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 4;
        gridBagConstraints.gridy = 24;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.BASELINE;
        optionsPanel.add(sideTieLengthSpinner, gridBagConstraints);

        // 26 ------------------------------------------------------------------
        tieWidthLabel.setText(Bundle.getMessage("TieWidthLabelText"));
        tieWidthLabel.setToolTipText(Bundle.getMessage("TieWidthToolTip"));
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 26;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.BASELINE_LEADING;
        optionsPanel.add(tieWidthLabel, gridBagConstraints);

        mainTieWidthSpinner.setModel(new javax.swing.SpinnerNumberModel(0, 0, null, 1));
        mainTieWidthSpinner.setToolTipText(Bundle.getMessage("MainTieWidthToolTip"));
        mainTieWidthSpinner.setEnabled(ltdOptions.getMainTieLength() > 0);
        mainTieWidthSpinner.setValue(ltdOptions.getMainTieWidth());
        mainTieWidthSpinner.addChangeListener(new javax.swing.event.ChangeListener() {
            @Override
            public void stateChanged(javax.swing.event.ChangeEvent evt) {
                mainTieWidthSpinnerStateChanged(evt);
            }
        });
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 2;
        gridBagConstraints.gridy = 26;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.BASELINE;
        optionsPanel.add(mainTieWidthSpinner, gridBagConstraints);

        sideTieWidthSpinner.setModel(new javax.swing.SpinnerNumberModel(0, 0, null, 1));
        sideTieWidthSpinner.setToolTipText(Bundle.getMessage("SideTieWidthToolTip"));
        sideTieWidthSpinner.setEnabled(ltdOptions.getSideTieLength() > 0);
        sideTieWidthSpinner.setValue(ltdOptions.getSideTieWidth());
        sideTieWidthSpinner.addChangeListener(new javax.swing.event.ChangeListener() {
            @Override
            public void stateChanged(javax.swing.event.ChangeEvent evt) {
                sideTieWidthSpinnerStateChanged(evt);
            }
        });
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 4;
        gridBagConstraints.gridy = 26;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.BASELINE;
        optionsPanel.add(sideTieWidthSpinner, gridBagConstraints);

        // 28 ------------------------------------------------------------------
        tieGapLabel.setText(Bundle.getMessage("TieGapLabelText"));
        tieGapLabel.setToolTipText(Bundle.getMessage("TieGapToolTip"));
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 28;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.BASELINE_LEADING;
        optionsPanel.add(tieGapLabel, gridBagConstraints);

        mainTieGapSpinner.setModel(new javax.swing.SpinnerNumberModel(0, 0, null, 1));
        mainTieGapSpinner.setToolTipText(Bundle.getMessage("MainTieGapToolTip"));
        mainTieGapSpinner.setEnabled(ltdOptions.getMainTieLength() > 0);
        mainTieGapSpinner.setValue(ltdOptions.getMainTieGap());
        mainTieGapSpinner.addChangeListener(new javax.swing.event.ChangeListener() {
            @Override
            public void stateChanged(javax.swing.event.ChangeEvent evt) {
                mainTieGapSpinnerStateChanged(evt);
            }
        });
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 2;
        gridBagConstraints.gridy = 28;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.BASELINE;
        optionsPanel.add(mainTieGapSpinner, gridBagConstraints);

        sideTieGapSpinner.setModel(new javax.swing.SpinnerNumberModel(0, 0, null, 1));
        sideTieGapSpinner.setToolTipText(Bundle.getMessage("SideTieGapToolTip"));
        sideTieGapSpinner.setEnabled(ltdOptions.getSideTieLength() > 0);
        sideTieGapSpinner.setValue(ltdOptions.getSideTieGap());
        sideTieGapSpinner.addChangeListener(new javax.swing.event.ChangeListener() {
            @Override
            public void stateChanged(javax.swing.event.ChangeEvent evt) {
                sideTieGapSpinnerStateChanged(evt);
            }
        });
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 4;
        gridBagConstraints.gridy = 28;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.BASELINE;
        optionsPanel.add(sideTieGapSpinner, gridBagConstraints);

        // 30 ------------------------------------------------------------------
        tieColorLabel.setText(Bundle.getMessage("TieColorLabelText"));
        tieColorLabel.setToolTipText(Bundle.getMessage("TieColorToolTip"));
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 30;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.BASELINE_LEADING;
        optionsPanel.add(tieColorLabel, gridBagConstraints);

        mainTieColorButton.setBackground(ltdOptions.getMainTieColor());
        mainTieColorButton.setToolTipText(Bundle.getMessage("MainTieColorToolTip"));
        mainTieColorButton.setBorder(javax.swing.BorderFactory.createBevelBorder(javax.swing.border.BevelBorder.LOWERED));
        mainTieColorButton.setEnabled(ltdOptions.getMainTieLength() > 0);
        mainTieColorButton.setOpaque(true);
        mainTieColorButton.addActionListener(new java.awt.event.ActionListener() {
            @Override
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                mainTieColorButtonActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout mainTieColorButtonLayout = new javax.swing.GroupLayout(mainTieColorButton);
        mainTieColorButton.setLayout(mainTieColorButtonLayout);
        mainTieColorButtonLayout.setHorizontalGroup(
            mainTieColorButtonLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 0, Short.MAX_VALUE)
        );
        mainTieColorButtonLayout.setVerticalGroup(
            mainTieColorButtonLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 0, Short.MAX_VALUE)
        );

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 2;
        gridBagConstraints.gridy = 30;
        gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.BASELINE;
        optionsPanel.add(mainTieColorButton, gridBagConstraints);

        sideTieColorButton.setBackground(ltdOptions.getSideTieColor());
        sideTieColorButton.setToolTipText(Bundle.getMessage("SideTieColorToolTip"));
        sideTieColorButton.setBorder(javax.swing.BorderFactory.createBevelBorder(javax.swing.border.BevelBorder.LOWERED));
        sideTieColorButton.setEnabled(ltdOptions.getSideTieLength() > 0);
        sideTieColorButton.setOpaque(true);
        sideTieColorButton.addActionListener(new java.awt.event.ActionListener() {
            @Override
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                sideTieColorButtonActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout sideTieColorButtonLayout = new javax.swing.GroupLayout(sideTieColorButton);
        sideTieColorButton.setLayout(sideTieColorButtonLayout);
        sideTieColorButtonLayout.setHorizontalGroup(
            sideTieColorButtonLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 0, Short.MAX_VALUE)
        );
        sideTieColorButtonLayout.setVerticalGroup(
            sideTieColorButtonLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 0, Short.MAX_VALUE)
        );

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 4;
        gridBagConstraints.gridy = 30;
        gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.BASELINE;
        optionsPanel.add(sideTieColorButton, gridBagConstraints);

        presetsLabel.setText(Bundle.getMessage("ButtonPresets"));

        presetsComboBox.setModel(new javax.swing.DefaultComboBoxModel<>(new String[] { "Classic JMRI", "Drafting", "Realistic", "Realistic Oh!", "Garrish", "--", "Custom" }));
        presetsComboBox.addActionListener(new java.awt.event.ActionListener() {
            @Override
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                presetsComboBoxActionPerformed(evt);
            }
        });

        applyButton.setText(Bundle.getMessage("ButtonApply"));
        applyButton.addActionListener(new java.awt.event.ActionListener() {
            @Override
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                applyButtonActionPerformed(evt);
            }
        });

        cancelButton.setText(Bundle.getMessage("ButtonCancel"));
        cancelButton.setActionCommand("cancelActionCommand");
        cancelButton.addActionListener(new java.awt.event.ActionListener() {
            @Override
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                cancelButtonActionPerformed(evt);
            }
        });

        okButton.setText(Bundle.getMessage("ButtonOK"));
        okButton.addActionListener(new java.awt.event.ActionListener() {
            @Override
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                okButtonActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout jPanelButtonsLayout = new javax.swing.GroupLayout(jPanelButtons);
        jPanelButtons.setLayout(jPanelButtonsLayout);
        jPanelButtonsLayout.setHorizontalGroup(
            jPanelButtonsLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanelButtonsLayout.createSequentialGroup()
                .addContainerGap()
                .addComponent(presetsLabel)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(presetsComboBox, javax.swing.GroupLayout.PREFERRED_SIZE, 200, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, 285, Short.MAX_VALUE)
                .addComponent(applyButton)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(cancelButton)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(okButton)
                .addContainerGap())
        );

        jPanelButtonsLayout.linkSize(javax.swing.SwingConstants.HORIZONTAL, new java.awt.Component[] {applyButton, cancelButton, okButton});

        jPanelButtonsLayout.setVerticalGroup(
            jPanelButtonsLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanelButtonsLayout.createSequentialGroup()
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addGroup(jPanelButtonsLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(presetsComboBox, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(presetsLabel)
                    .addComponent(applyButton)
                    .addComponent(cancelButton)
                    .addComponent(okButton))
                .addContainerGap())
        );

        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(getContentPane());
        getContentPane().setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(optionsPanel, javax.swing.GroupLayout.Alignment.TRAILING, javax.swing.GroupLayout.DEFAULT_SIZE, 722, Short.MAX_VALUE)
            .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                .addComponent(jPanelButtons, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );
        layout.setVerticalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addComponent(optionsPanel, javax.swing.GroupLayout.PREFERRED_SIZE, 632, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(0, 68, Short.MAX_VALUE))
            .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, layout.createSequentialGroup()
                    .addGap(0, 542, Short.MAX_VALUE)
                    .addComponent(jPanelButtons, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)))
        );

        pack();
    }// </editor-fold>//GEN-END:initComponents

    /*==========================*\
    |* action performed methods *|
    \*==========================*/

    /***************************************************************************
     * OK button action performed.
     * Non-systemic color adjustment solution for blockDefaultColor, blockOccupiedColor and blockAlternativeColor.
     * 
     * @param evt event
     */
    private void okButtonActionPerformed(ActionEvent evt) {//GEN-FIRST:event_okButtonActionPerformed
        log.debug("okButtonActionPerformed({}", evt);
        
        // ----------------------------------------            
        layoutEditor.setDefaultTrackColor(ltdOptions.getBlockDefaultColor());
        layoutEditor.setDefaultOccupiedTrackColor(ltdOptions.getBlockOccupiedColor());
        layoutEditor.setDefaultAlternativeTrackColor(ltdOptions.getBlockAlternativeColor());
        layoutEditor.setDirty();
        layoutEditor.redrawPanel();
        // ----------------------------------------            

        ltdOptions.setName(layoutEditor.getLayoutName());
        layoutEditor.setLayoutTrackDrawingOptions(ltdOptions);
        ltdOptions = null;
        setVisible(false);
        dispose();
    }//GEN-LAST:event_okButtonActionPerformed

    /***************************************************************************
     * Apply button action performed.
     * Non-systemic color adjustment solution for blockDefaultColor, blockOccupiedColor and blockAlternativeColor.
     * 
     * @param evt event
     */
    private void applyButtonActionPerformed(ActionEvent evt) {//GEN-FIRST:event_applyButtonActionPerformed
        
        // ----------------------------------------            
        layoutEditor.setDefaultTrackColor(ltdOptions.getBlockDefaultColor());
        layoutEditor.setDefaultOccupiedTrackColor(ltdOptions.getBlockOccupiedColor());
        layoutEditor.setDefaultAlternativeTrackColor(ltdOptions.getBlockAlternativeColor());
        layoutEditor.setDirty();
        layoutEditor.redrawPanel();
        // ----------------------------------------            

        LayoutTrackDrawingOptions ltdo = new LayoutTrackDrawingOptions(ltdOptions);
        ltdo.setName(layoutEditor.getLayoutName());
        layoutEditor.setLayoutTrackDrawingOptions(ltdo);
    }//GEN-LAST:event_applyButtonActionPerformed

    private void presetsComboBoxActionPerformed(ActionEvent evt) {//GEN-FIRST:event_presetsComboBoxActionPerformed
        log.debug("presetsComboBoxActionPerformed({}", evt);
        int modifiers = evt.getModifiers();
        if (modifiers != 0) {   // don't do this unless it's a mouse click
            String presetName = (String) presetsComboBox.getSelectedItem();
            for (LayoutTrackDrawingOptions ltdo : ltdoList) {
                if (ltdo.getName().equals(presetName)) {
                    if (!ltdOptions.getName().equals(ltdo.getName())) {
                        ltdOptions = ltdo;
                        setupControls();
                        optionsPanel.setBorder(BorderFactory.createTitledBorder(presetName));
                        presetsComboBox.setSelectedItem(presetName);
                    }
                    break;
                }
            }
        } 
    }//GEN-LAST:event_presetsComboBoxActionPerformed

    private void cancelButtonActionPerformed(ActionEvent evt) {//GEN-FIRST:event_cancelButtonActionPerformed
        log.debug("cancelButtonActionPerformed({}", evt);
        // restore orginal settings
        layoutEditor.setLayoutTrackDrawingOptions(leLTDOptions);
        setVisible(false);
        dispose();
    }//GEN-LAST:event_cancelButtonActionPerformed

    private void sideTieGapSpinnerStateChanged(ChangeEvent evt) {//GEN-FIRST:event_sideTieGapSpinnerStateChanged
        JSpinner spinner = (JSpinner) evt.getSource();
        Integer value = (Integer) spinner.getValue();
        makeCustomPreset();
        ltdOptions.setSideTieGap(value.intValue());
        log.debug("sideTieGapSpinnerStateChanged({})", value);
    }//GEN-LAST:event_sideTieGapSpinnerStateChanged

    private void mainTieGapSpinnerStateChanged(ChangeEvent evt) {//GEN-FIRST:event_mainTieGapSpinnerStateChanged
        JSpinner spinner = (JSpinner) evt.getSource();
        Integer value = (Integer) spinner.getValue();
        makeCustomPreset();
        ltdOptions.setMainTieGap(value.intValue());
        log.debug("mainTieGapSpinnerStateChanged({})", value);
    }//GEN-LAST:event_mainTieGapSpinnerStateChanged

    private void sideTieWidthSpinnerStateChanged(ChangeEvent evt) {//GEN-FIRST:event_sideTieWidthSpinnerStateChanged
        JSpinner spinner = (JSpinner) evt.getSource();
        Integer value = (Integer) spinner.getValue();
        makeCustomPreset();
        ltdOptions.setSideTieWidth(value.intValue());
        log.debug("sideTieWidthSpinnerStateChanged({})", value);
    }//GEN-LAST:event_sideTieWidthSpinnerStateChanged

    private void mainTieWidthSpinnerStateChanged(ChangeEvent evt) {//GEN-FIRST:event_mainTieWidthSpinnerStateChanged
        JSpinner spinner = (JSpinner) evt.getSource();
        Integer value = (Integer) spinner.getValue();
        makeCustomPreset();
        ltdOptions.setMainTieWidth(value.intValue());
        log.debug("mainTieWidthSpinnerStateChanged({})", value);
    }//GEN-LAST:event_mainTieWidthSpinnerStateChanged

    private void sideTieLengthSpinnerStateChanged(ChangeEvent evt) {//GEN-FIRST:event_sideTieLengthSpinnerStateChanged
        JSpinner spinner = (JSpinner) evt.getSource();
        Integer value = (Integer) spinner.getValue();
        makeCustomPreset();
        ltdOptions.setSideTieLength(value.intValue());
        log.debug("sideTieLengthSpinnerStateChanged({})", value);
        sideTieColorButton.setEnabled(value > 0);
        sideTieGapSpinner.setEnabled(value > 0);
        sideTieWidthSpinner.setEnabled(value > 0);
    }//GEN-LAST:event_sideTieLengthSpinnerStateChanged

    private void mainTieLengthSpinnerStateChanged(ChangeEvent evt) {//GEN-FIRST:event_mainTieLengthSpinnerStateChanged
        JSpinner spinner = (JSpinner) evt.getSource();
        Integer value = (Integer) spinner.getValue();
        makeCustomPreset();
        ltdOptions.setMainTieLength(value.intValue());
        log.debug("mainTieLengthSpinnerStateChanged({})", value);
        mainTieColorButton.setEnabled(value > 0);
        mainTieGapSpinner.setEnabled(value > 0);
        mainTieWidthSpinner.setEnabled(value > 0);
    }//GEN-LAST:event_mainTieLengthSpinnerStateChanged

    private void sideBallastWidthSpinnerStateChanged(ChangeEvent evt) {//GEN-FIRST:event_sideBallastWidthSpinnerStateChanged
        JSpinner spinner = (JSpinner) evt.getSource();
        Integer value = (Integer) spinner.getValue();
        makeCustomPreset();
        ltdOptions.setSideBallastWidth(value.intValue());
        log.debug("sideBallastWidthSpinnerStateChanged({})", value);
    }//GEN-LAST:event_sideBallastWidthSpinnerStateChanged

    private void mainBallastWidthSpinnerStateChanged(ChangeEvent evt) {//GEN-FIRST:event_mainBallastWidthSpinnerStateChanged
        JSpinner spinner = (JSpinner) evt.getSource();
        Integer value = (Integer) spinner.getValue();
        makeCustomPreset();
        ltdOptions.setMainBallastWidth(value.intValue());
        log.debug("mainBallastWidthSpinnerStateChanged({})", value);
    }//GEN-LAST:event_mainBallastWidthSpinnerStateChanged

    private void sideBlockLineWidthSpinnerStateChanged(ChangeEvent evt) {//GEN-FIRST:event_sideBlockLineWidthSpinnerStateChanged
        JSpinner spinner = (JSpinner) evt.getSource();
        Integer value = (Integer) spinner.getValue();
        makeCustomPreset();
        ltdOptions.setSideBlockLineWidth(value.intValue());
        log.debug("sideBlockLineWidthSpinnerStateChanged({})", value);
        sideBlockLineDashPercentageX10Spinner.setEnabled(value > 0);
    }//GEN-LAST:event_sideBlockLineWidthSpinnerStateChanged

    private void mainBlockLineWidthSpinnerStateChanged(ChangeEvent evt) {//GEN-FIRST:event_mainBlockLineWidthSpinnerStateChanged
        JSpinner spinner = (JSpinner) evt.getSource();
        Integer value = (Integer) spinner.getValue();
        makeCustomPreset();
        ltdOptions.setMainBlockLineWidth(value.intValue());
        log.debug("mainBlockLineWidthSpinnerStateChanged({})", value);
        mainBlockLineDashPercentageX10Spinner.setEnabled(value > 0);
    }//GEN-LAST:event_mainBlockLineWidthSpinnerStateChanged

    private void mainRailGapSpinnerStateChanged(ChangeEvent evt) {//GEN-FIRST:event_mainRailGapSpinnerStateChanged
        JSpinner spinner = (JSpinner) evt.getSource();
        Integer value = (Integer) spinner.getValue();
        makeCustomPreset();
        ltdOptions.setMainRailGap(value.intValue());
        log.debug("sideRailGapSpinnerStateChanged({})", value);
    }//GEN-LAST:event_mainRailGapSpinnerStateChanged

    private void sideRailGapSpinnerStateChanged(ChangeEvent evt) {//GEN-FIRST:event_sideRailGapSpinnerStateChanged
        JSpinner spinner = (JSpinner) evt.getSource();
        Integer value = (Integer) spinner.getValue();
        makeCustomPreset();
        ltdOptions.setSideRailGap(value.intValue());
        log.debug("mainRailGapSpinnerStateChanged({})", value);
    }//GEN-LAST:event_sideRailGapSpinnerStateChanged

    private void sideRailWidthSpinnerStateChanged(ChangeEvent evt) {//GEN-FIRST:event_sideRailWidthSpinnerStateChanged
        JSpinner spinner = (JSpinner) evt.getSource();
        Integer value = (Integer) spinner.getValue();
        makeCustomPreset();
        ltdOptions.setSideRailWidth(value.intValue());
        log.debug("sideRailWidthSpinnerStateChanged({})", value);
    }//GEN-LAST:event_sideRailWidthSpinnerStateChanged

    private void mainRailWidthSpinnerStateChanged(ChangeEvent evt) {//GEN-FIRST:event_mainRailWidthSpinnerStateChanged
        JSpinner spinner = (JSpinner) evt.getSource();
        Integer value = (Integer) spinner.getValue();
        makeCustomPreset();
        ltdOptions.setMainRailWidth(value.intValue());
        log.debug("mainRailWidthSpinnerStateChanged({})", value);
    }//GEN-LAST:event_mainRailWidthSpinnerStateChanged

    private void sideRailCountSpinnerStateChanged(ChangeEvent evt) {//GEN-FIRST:event_sideRailCountSpinnerStateChanged
        JSpinner spinner = (JSpinner) evt.getSource();
        Integer value = (Integer) spinner.getValue();
        makeCustomPreset();
        ltdOptions.setSideRailCount(value.intValue());
        log.debug("sideRailCountSpinnerStateChanged({})", value);
        sideRailColorButton.setEnabled(value > 0);
        sideRailGapSpinner.setEnabled(value > 1);
        sideRailWidthSpinner.setEnabled(value > 0);
    }//GEN-LAST:event_sideRailCountSpinnerStateChanged

    private void mainRailCountSpinnerStateChanged(ChangeEvent evt) {//GEN-FIRST:event_mainRailCountSpinnerStateChanged
        JSpinner spinner = (JSpinner) evt.getSource();
        Integer value = (Integer) spinner.getValue();
        makeCustomPreset();
        ltdOptions.setMainRailCount(value.intValue());
        log.debug("mainRailCountSpinnerStateChanged({})", value);
        mainRailColorButton.setEnabled(value > 0);
        mainRailGapSpinner.setEnabled(value > 1);
        mainRailWidthSpinner.setEnabled(value > 0);
    }//GEN-LAST:event_mainRailCountSpinnerStateChanged

    private void mainRailColorButtonActionPerformed(ActionEvent evt) {//GEN-FIRST:event_mainRailColorButtonActionPerformed
        JButton button = (JButton) evt.getSource();
        Color value = button.getBackground();
        Color newColor = JmriColorChooser.showDialog(null, "Choose a color", value);
        if ((newColor != null) && !newColor.equals(value)) {
            makeCustomPreset();
            button.setBackground(newColor);
            ltdOptions.setMainRailColor(newColor);
        }
        log.info("*mainRailColorButtonActionPerformed({})", newColor);
    }//GEN-LAST:event_mainRailColorButtonActionPerformed

    private void sideRailColorButtonActionPerformed(ActionEvent evt) {//GEN-FIRST:event_sideRailColorButtonActionPerformed
        JButton button = (JButton) evt.getSource();
        Color value = button.getBackground();
        Color newColor = JmriColorChooser.showDialog(null, "Choose a color", value);
        if ((newColor != null) && !newColor.equals(value)) {
            makeCustomPreset();
            button.setBackground(newColor);
            ltdOptions.setSideRailColor(newColor);
        }
        log.info("*sideRailColorButtonActionPerformed({})", newColor);
    }//GEN-LAST:event_sideRailColorButtonActionPerformed

    private void mainBallastColorButtonActionPerformed(ActionEvent evt) {//GEN-FIRST:event_mainBallastColorButtonActionPerformed
        JButton button = (JButton) evt.getSource();
        Color value = button.getBackground();
        Color newColor = JmriColorChooser.showDialog(null, "Choose a color", value);
        if ((newColor != null) && !newColor.equals(value)) {
            makeCustomPreset();
            button.setBackground(newColor);
            ltdOptions.setMainBallastColor(newColor);
        }
        log.info("*mainBallastColorButtonActionPerformed({})", newColor);
    }//GEN-LAST:event_mainBallastColorButtonActionPerformed

    private void sideBallastColorButtonActionPerformed(ActionEvent evt) {//GEN-FIRST:event_sideBallastColorButtonActionPerformed
        JButton button = (JButton) evt.getSource();
        Color value = button.getBackground();
        Color newColor = JmriColorChooser.showDialog(null, "Choose a color", value);
        if ((newColor != null) && !newColor.equals(value)) {
            makeCustomPreset();
            button.setBackground(newColor);
            ltdOptions.setSideBallastColor(newColor);
        }
        log.info("*sideBallastColorButtonActionPerformed({})", newColor);
    }//GEN-LAST:event_sideBallastColorButtonActionPerformed

    private void mainTieColorButtonActionPerformed(ActionEvent evt) {//GEN-FIRST:event_mainTieColorButtonActionPerformed
        JButton button = (JButton) evt.getSource();
        Color value = button.getBackground();
        Color newColor = JmriColorChooser.showDialog(null, "Choose a color", value);
        if ((newColor != null) && !newColor.equals(value)) {
            makeCustomPreset();
            button.setBackground(newColor);
            ltdOptions.setMainTieColor(newColor);
        }
        log.info("*mainTieColorButtonActionPerformed({})", newColor);
    }//GEN-LAST:event_mainTieColorButtonActionPerformed

    private void sideTieColorButtonActionPerformed(ActionEvent evt) {//GEN-FIRST:event_sideTieColorButtonActionPerformed
        JButton button = (JButton) evt.getSource();
        Color value = button.getBackground();
        Color newColor = JmriColorChooser.showDialog(null, "Choose a color", value);
        if ((newColor != null) && !newColor.equals(value)) {
            makeCustomPreset();
            button.setBackground(newColor);
            ltdOptions.setSideTieColor(newColor);
        }
        log.info("*sideTieColorButtonActionPerformed({})", newColor);
    }//GEN-LAST:event_sideTieColorButtonActionPerformed

    private void blockDefaultColorButtonActionPerformed(ActionEvent evt) {//GEN-FIRST:event_blockDefaultColorButtonActionPerformed
        JButton button = (JButton) evt.getSource();
        Color value = button.getBackground();
        Color newColor = JmriColorChooser.showDialog(null, Bundle.getMessage("DefaultTrackColor"), value);
        if ((newColor != null) && !newColor.equals(value)) {
            makeCustomPreset();
            button.setBackground(newColor);
            ltdOptions.setBlockDefaultColor(newColor);
        }
        log.info("*blockDefaultColorButtonActionPerformed({})", newColor);
    }//GEN-LAST:event_blockDefaultColorButtonActionPerformed

    private void blockOccupiedColorButtonActionPerformed(ActionEvent evt) {//GEN-FIRST:event_blockOccupiedColorButtonActionPerformed
        JButton button = (JButton) evt.getSource();
        Color value = button.getBackground();
        Color newColor = JmriColorChooser.showDialog(null, Bundle.getMessage("DefaultOccupiedTrackColor"), value);
        if ((newColor != null) && !newColor.equals(value)) {
            makeCustomPreset();
            button.setBackground(newColor);
            ltdOptions.setBlockOccupiedColor(newColor);
        }
        log.info("*blockOccupiedColorButtonActionPerformed({})", newColor);
    }//GEN-LAST:event_blockOccupiedColorButtonActionPerformed

    private void blockAlternativeColorButtonActionPerformed(ActionEvent evt) {//GEN-FIRST:event_blockAlternativeColorButtonActionPerformed
        JButton button = (JButton) evt.getSource();
        Color value = button.getBackground();
        Color newColor = JmriColorChooser.showDialog(null, Bundle.getMessage("DefaultAlternativeTrackColor"), value);
        if ((newColor != null) && !newColor.equals(value)) {
            makeCustomPreset();
            button.setBackground(newColor);
            ltdOptions.setBlockAlternativeColor(newColor);
        }
        log.info("*blockAlternativeColorButtonActionPerformed({})", newColor);
    }//GEN-LAST:event_blockAlternativeColorButtonActionPerformed

    
    private void mainBlockLineDashPercentageX10SpinnerStateChanged(ChangeEvent evt) {//GEN-FIRST:event_mainBlockLineDashPercentageX10SpinnerStateChanged
        JSpinner spinner = (JSpinner) evt.getSource();
        Integer value = (Integer) spinner.getValue();
        makeCustomPreset();
        ltdOptions.setMainBlockLineDashPercentageX10(value.intValue());
        log.debug("mainBlockLineDashPercentageX10SpinnerStateChanged({})", value);
    }//GEN-LAST:event_mainBlockLineDashPercentageX10SpinnerStateChanged

    private void sideBlockLineDashPercentageX10SpinnerStateChanged(ChangeEvent evt) {//GEN-FIRST:event_sideBlockLineDashPercentageX10SpinnerStateChanged
        JSpinner spinner = (JSpinner) evt.getSource();
        Integer value = (Integer) spinner.getValue();
        makeCustomPreset();
        ltdOptions.setSideBlockLineDashPercentageX10(value.intValue());
        log.debug("sideBlockLineDashPercentageX10({})", value);
    }//GEN-LAST:event_sideBlockLineDashPercentageX10SpinnerStateChanged

    /*=========================*\
    |* local (private) methods *|
    \*=========================*/
    private void setupControls() {
        copyToCustom = false;   // prevent xxx.setValue's from creating custom preset

        blockDefaultColorButton.setBackground(ltdOptions.getBlockDefaultColor());
        blockOccupiedColorButton.setBackground(ltdOptions.getBlockOccupiedColor());
        blockAlternativeColorButton.setBackground(ltdOptions.getBlockAlternativeColor());
        
        mainBallastColorButton.setBackground(ltdOptions.getMainBallastColor());
        mainBallastWidthSpinner.setValue(ltdOptions.getMainBallastWidth());
        mainBlockLineDashPercentageX10Spinner.setValue(ltdOptions.getMainBlockLineDashPercentageX10());
        mainBlockLineWidthSpinner.setValue(ltdOptions.getMainBlockLineWidth());
        mainRailColorButton.setBackground(ltdOptions.getMainRailColor());
        mainRailCountSpinner.setValue(ltdOptions.getMainRailCount());
        mainRailGapSpinner.setValue(ltdOptions.getMainRailGap());
        mainRailWidthSpinner.setValue(ltdOptions.getMainRailWidth());
        mainTieColorButton.setBackground(ltdOptions.getMainTieColor());
        mainTieGapSpinner.setValue(ltdOptions.getMainTieGap());
        mainTieLengthSpinner.setValue(ltdOptions.getMainTieLength());
        mainTieWidthSpinner.setValue(ltdOptions.getMainTieWidth());
        sideBallastColorButton.setBackground(ltdOptions.getSideBallastColor());
        sideBallastWidthSpinner.setValue(ltdOptions.getSideBallastWidth());
        sideBlockLineDashPercentageX10Spinner.setValue(ltdOptions.getSideBlockLineDashPercentageX10());
        sideBlockLineWidthSpinner.setValue(ltdOptions.getSideBlockLineWidth());
        sideRailColorButton.setBackground(ltdOptions.getSideRailColor());
        sideRailCountSpinner.setValue(ltdOptions.getSideRailCount());
        sideRailGapSpinner.setValue(ltdOptions.getSideRailGap());
        sideRailWidthSpinner.setValue(ltdOptions.getSideRailWidth());
        sideTieColorButton.setBackground(ltdOptions.getSideTieColor());
        sideTieGapSpinner.setValue(ltdOptions.getSideTieGap());
        sideTieLengthSpinner.setValue(ltdOptions.getSideTieLength());
        sideTieWidthSpinner.setValue(ltdOptions.getSideTieWidth());
        copyToCustom = true;
    }   // setupControls

    // used to prevent xxx.setValue's in setupControls from creating custom preset
    private boolean copyToCustom = true;

    private void makeCustomPreset() {
        if (copyToCustom && !ltdOptions.getName().equals(customPresetName)) {
            ltdOptions = new LayoutTrackDrawingOptions(ltdOptions);
            ltdOptions.setName(customPresetName);
            if (!ltdoList.get(ltdoList.size() - 1).getName().equals(customPresetName)) {
                ltdoList.add(ltdOptions);
                presetsComboBox.addItem(ltdOptions.getName());
            }
            presetsComboBox.setSelectedItem(ltdOptions.getName());
            optionsPanel.setBorder(BorderFactory.createTitledBorder(customPresetName));
        }
    }
    // define the presets

    private void definePresets() {
        LayoutTrackDrawingOptions tempLTDO = new LayoutTrackDrawingOptions(classicPresetName);
        tempLTDO.setMainBallastColor(Color.BLACK);
        tempLTDO.setMainBallastWidth(0);
        tempLTDO.setMainBlockLineDashPercentageX10(0);
        tempLTDO.setMainBlockLineWidth(4);
        tempLTDO.setMainRailColor(Color.BLACK);
        tempLTDO.setMainRailCount(1);
        tempLTDO.setMainRailGap(0);
        tempLTDO.setMainRailWidth(2);
        tempLTDO.setMainTieColor(Color.BLACK);
        tempLTDO.setMainTieGap(0);
        tempLTDO.setMainTieLength(0);
        tempLTDO.setMainTieWidth(0);
        tempLTDO.setSideBallastColor(Color.BLACK);
        tempLTDO.setSideBallastWidth(0);
        tempLTDO.setSideBlockLineDashPercentageX10(0);
        tempLTDO.setSideBlockLineWidth(2);
        tempLTDO.setSideRailColor(Color.BLACK);
        tempLTDO.setSideRailCount(1);
        tempLTDO.setSideRailGap(0);
        tempLTDO.setSideRailWidth(1);
        tempLTDO.setSideTieColor(Color.BLACK);
        tempLTDO.setSideTieGap(0);
        tempLTDO.setSideTieLength(0);
        tempLTDO.setSideTieWidth(0);
        tempLTDO.setBlockDefaultColor(Color.GRAY);
        tempLTDO.setBlockOccupiedColor(Color.RED);
        tempLTDO.setBlockAlternativeColor(Color.WHITE);
        ltdoList.add(tempLTDO);

        tempLTDO = new LayoutTrackDrawingOptions(draftingPresetName);
        tempLTDO.setMainBallastColor(Color.BLACK);
        tempLTDO.setMainBallastWidth(0);
        tempLTDO.setMainBlockLineDashPercentageX10(0);
        tempLTDO.setMainBlockLineWidth(4);
        tempLTDO.setMainRailColor(Color.BLACK);
        tempLTDO.setMainRailCount(2);
        tempLTDO.setMainRailGap(2);
        tempLTDO.setMainRailWidth(2);
        tempLTDO.setMainTieColor(Color.BLACK);
        tempLTDO.setMainTieGap(0);
        tempLTDO.setMainTieLength(0);
        tempLTDO.setMainTieWidth(0);
        tempLTDO.setSideBallastColor(Color.BLACK);
        tempLTDO.setSideBallastWidth(0);
        tempLTDO.setSideBlockLineDashPercentageX10(0);
        tempLTDO.setSideBlockLineWidth(4);
        tempLTDO.setSideRailColor(Color.BLACK);
        tempLTDO.setSideRailCount(2);
        tempLTDO.setSideRailGap(3);
        tempLTDO.setSideRailWidth(1);
        tempLTDO.setSideTieColor(Color.BLACK);
        tempLTDO.setSideTieGap(0);
        tempLTDO.setSideTieLength(0);
        tempLTDO.setSideTieWidth(0);
        tempLTDO.setBlockDefaultColor(Color.GRAY);
        tempLTDO.setBlockOccupiedColor(Color.RED);
        tempLTDO.setBlockAlternativeColor(Color.WHITE);
        ltdoList.add(tempLTDO);

        tempLTDO = new LayoutTrackDrawingOptions(realisticPresetName);
        tempLTDO.setMainBallastColor(Color.decode("#A0A0A0"));
        tempLTDO.setMainBallastWidth(13);
        tempLTDO.setMainBlockLineDashPercentageX10(0);
        tempLTDO.setMainBlockLineWidth(2);
        tempLTDO.setMainRailColor(Color.decode("#C0C0C0"));
        tempLTDO.setMainRailCount(2);
        tempLTDO.setMainRailGap(3);
        tempLTDO.setMainRailWidth(2);
        tempLTDO.setMainTieColor(Color.decode("#E0E0E0"));
        tempLTDO.setMainTieGap(7);
        tempLTDO.setMainTieLength(11);
        tempLTDO.setMainTieWidth(1);
        tempLTDO.setSideBallastColor(Color.GRAY);
        tempLTDO.setSideBallastWidth(11);
        tempLTDO.setSideBlockLineDashPercentageX10(0);
        tempLTDO.setSideBlockLineWidth(2);
        tempLTDO.setSideRailColor(Color.decode("#D07060"));
        tempLTDO.setSideRailCount(2);
        tempLTDO.setSideRailGap(3);
        tempLTDO.setSideRailWidth(1);
        tempLTDO.setSideTieColor(Color.decode("#382018"));
        tempLTDO.setSideTieGap(6);
        tempLTDO.setSideTieLength(9);
        tempLTDO.setSideTieWidth(3);
        tempLTDO.setBlockDefaultColor(Color.GRAY);
        tempLTDO.setBlockOccupiedColor(Color.RED);
        tempLTDO.setBlockAlternativeColor(Color.WHITE);
        ltdoList.add(tempLTDO);

        tempLTDO = new LayoutTrackDrawingOptions(realisticOhPresetName);
        tempLTDO.setMainBallastColor(Color.decode("#A0A0A0"));
        tempLTDO.setMainBallastWidth(26);
        tempLTDO.setMainBlockLineDashPercentageX10(0);
        tempLTDO.setMainBlockLineWidth(4);
        tempLTDO.setMainRailColor(Color.LIGHT_GRAY);
        tempLTDO.setMainRailCount(3);
        tempLTDO.setMainRailGap(6);
        tempLTDO.setMainRailWidth(2);
        tempLTDO.setMainTieColor(Color.decode("#E0E0E0"));
        tempLTDO.setMainTieGap(14);
        tempLTDO.setMainTieLength(22);
        tempLTDO.setMainTieWidth(2);
        tempLTDO.setSideBallastColor(Color.GRAY);
        tempLTDO.setSideBallastWidth(22);
        tempLTDO.setSideBlockLineDashPercentageX10(0);
        tempLTDO.setSideBlockLineWidth(4);
        tempLTDO.setSideRailColor(Color.decode("#D07060"));
        tempLTDO.setSideRailCount(3);
        tempLTDO.setSideRailGap(6);
        tempLTDO.setSideRailWidth(2);
        tempLTDO.setSideTieColor(Color.decode("#382018"));
        tempLTDO.setSideTieGap(12);
        tempLTDO.setSideTieLength(18);
        tempLTDO.setSideTieWidth(6);
        tempLTDO.setBlockDefaultColor(Color.GRAY);
        tempLTDO.setBlockOccupiedColor(Color.RED);
        tempLTDO.setBlockAlternativeColor(Color.WHITE);
        ltdoList.add(tempLTDO);

        tempLTDO = new LayoutTrackDrawingOptions(british70sPresetName);
        tempLTDO.setMainBallastColor(Color.BLACK);
        tempLTDO.setMainBallastWidth(5);
        tempLTDO.setMainBlockLineDashPercentageX10(5);
        tempLTDO.setMainBlockLineWidth(4);
        tempLTDO.setMainRailColor(Color.BLACK);
        tempLTDO.setMainRailCount(0);
        tempLTDO.setMainRailGap(0);
        tempLTDO.setMainRailWidth(2);
        tempLTDO.setMainTieColor(Color.BLACK);
        tempLTDO.setMainTieGap(0);
        tempLTDO.setMainTieLength(0);
        tempLTDO.setMainTieWidth(0);
        tempLTDO.setSideBallastColor(Color.BLACK);
        tempLTDO.setSideBallastWidth(3);
        tempLTDO.setSideBlockLineDashPercentageX10(5);
        tempLTDO.setSideBlockLineWidth(2);
        tempLTDO.setSideRailColor(Color.BLACK);
        tempLTDO.setSideRailCount(0);
        tempLTDO.setSideRailGap(0);
        tempLTDO.setSideRailWidth(1);
        tempLTDO.setSideTieColor(Color.BLACK);
        tempLTDO.setSideTieGap(0);
        tempLTDO.setSideTieLength(0);
        tempLTDO.setSideTieWidth(0);
        tempLTDO.setBlockDefaultColor(Color.GRAY);
        tempLTDO.setBlockOccupiedColor(Color.RED);
        tempLTDO.setBlockAlternativeColor(Color.WHITE);
        ltdoList.add(tempLTDO);

        tempLTDO = new LayoutTrackDrawingOptions(csdazd71PresetName);
        tempLTDO.setMainBallastColor(Color.decode("#000000"));
        tempLTDO.setMainBallastWidth(0);
        tempLTDO.setMainBlockLineDashPercentageX10(6);
        tempLTDO.setMainBlockLineWidth(6);
        tempLTDO.setMainRailColor(Color.decode("#000000"));
        tempLTDO.setMainRailCount(1);
        tempLTDO.setMainRailGap(0);
        tempLTDO.setMainRailWidth(10);
        tempLTDO.setMainTieColor(Color.decode("#000000"));
        tempLTDO.setMainTieGap(0);
        tempLTDO.setMainTieLength(0);
        tempLTDO.setMainTieWidth(0);
        tempLTDO.setSideBallastColor(Color.decode("#000000"));
        tempLTDO.setSideBallastWidth(0);
        tempLTDO.setSideBlockLineDashPercentageX10(6);
        tempLTDO.setSideBlockLineWidth(6);
        tempLTDO.setSideRailColor(Color.decode("#000000"));
        tempLTDO.setSideRailCount(1);
        tempLTDO.setSideRailGap(0);
        tempLTDO.setSideRailWidth(10);
        tempLTDO.setSideTieColor(Color.decode("#000000"));
        tempLTDO.setSideTieGap(0);
        tempLTDO.setSideTieLength(0);
        tempLTDO.setSideTieWidth(0);
        tempLTDO.setBlockDefaultColor(Color.decode("#606060"));
        tempLTDO.setBlockOccupiedColor(Color.decode("#E00000"));
        tempLTDO.setBlockAlternativeColor(Color.decode("#FFFFE0"));
        ltdoList.add(tempLTDO);

        ltdoList.add(ltdOptions);

        presetsComboBox.removeAllItems();
        ltdoList.forEach((ltdo) -> {
            presetsComboBox.addItem(ltdo.getName());
        });
        presetsComboBox.setSelectedItem(leLTDOptions.getName());
    }   // definePresets

    /*===========================*\
    |* local (private) variables *|
    \*===========================*/

    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JButton applyButton;
    
    private javax.swing.JButton blockDefaultColorButton;
    private javax.swing.JButton blockOccupiedColorButton;
    private javax.swing.JButton blockAlternativeColorButton;
    
    private javax.swing.JLabel ballastWidthLabel;
    private javax.swing.JLabel blockLineDashPercentageX10Label;
    private javax.swing.JLabel blockLineWidthLabel;
    private javax.swing.JButton cancelButton;
    private javax.swing.JPanel jPanelButtons;
    private javax.swing.JButton mainBallastColorButton;
    private javax.swing.JSpinner mainBallastWidthSpinner;
    private javax.swing.JSpinner mainBlockLineDashPercentageX10Spinner;
    private javax.swing.JSpinner mainBlockLineWidthSpinner;
    private javax.swing.JButton mainRailColorButton;
    private javax.swing.JSpinner mainRailCountSpinner;
    private javax.swing.JSpinner mainRailGapSpinner;
    private javax.swing.JSpinner mainRailWidthSpinner;
    private javax.swing.JButton mainTieColorButton;
    private javax.swing.JSpinner mainTieGapSpinner;
    private javax.swing.JSpinner mainTieLengthSpinner;
    private javax.swing.JSpinner mainTieWidthSpinner;
    private javax.swing.JLabel mainlineLabel;
    private javax.swing.JButton okButton;
    private javax.swing.JLabel optionLabel;
    private javax.swing.JPanel optionsPanel;
    private javax.swing.JComboBox<String> presetsComboBox;
    private javax.swing.JLabel presetsLabel;
    private javax.swing.JLabel railCountLabel;
    private javax.swing.JLabel railGapLabel;
    private javax.swing.JLabel railWidthLabel;
    private javax.swing.JButton sideBallastColorButton;
    private javax.swing.JSpinner sideBallastWidthSpinner;
    private javax.swing.JSpinner sideBlockLineDashPercentageX10Spinner;
    private javax.swing.JSpinner sideBlockLineWidthSpinner;
    private javax.swing.JButton sideRailColorButton;
    private javax.swing.JSpinner sideRailCountSpinner;
    private javax.swing.JSpinner sideRailGapSpinner;
    private javax.swing.JSpinner sideRailWidthSpinner;
    private javax.swing.JButton sideTieColorButton;
    private javax.swing.JSpinner sideTieGapSpinner;
    private javax.swing.JSpinner sideTieLengthSpinner;
    private javax.swing.JSpinner sideTieWidthSpinner;
    private javax.swing.JLabel sidelineLabel;
    private javax.swing.JLabel tieGapLabel;
    private javax.swing.JLabel tieLengthLabel;
    private javax.swing.JLabel tieWidthLabel;
    // End of variables declaration//GEN-END:variables

    /*====================*\
    |* initialize logging *|
    \*====================*/
    private transient final static Logger log
            = LoggerFactory.getLogger(LayoutTrackDrawingOptionsDialog.class);
}
